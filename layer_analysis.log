nohup: ignoring input
2024-12-18:22:07:31,166 INFO     [utils.py:162] NumExpr defaulting to 16 threads.
2024-12-18:22:07:37,609 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:07:52,112 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:07:52,165 INFO     [evaluator.py:319] Running loglikelihood requests
Looking for models in: checkpoints/meta-llama/Meta-Llama-3-8B
INT8 model path: checkpoints/meta-llama/Meta-Llama-3-8B/model_int8.pth
INT4 model path: checkpoints/meta-llama/Meta-Llama-3-8B/model_int4.g32.pth
Tokenizer path: checkpoints/meta-llama/Meta-Llama-3-8B/tokenizer.model
Loading models...
Loading INT4 model...
Loading INT8 model...
Loading tokenizer...
Initializing analyzer...
Running analysis...
Evaluating INT4 and INT8 baselines...
int4 baseline

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<01:17,  2.58it/s]
  1%|          | 2/200 [00:00<00:52,  3.77it/s]
  2%|▏         | 3/200 [00:00<00:44,  4.46it/s]
  2%|▏         | 4/200 [00:00<00:39,  5.00it/s]
  2%|▎         | 5/200 [00:01<00:36,  5.30it/s]
  3%|▎         | 6/200 [00:01<00:34,  5.60it/s]
  4%|▎         | 7/200 [00:01<00:33,  5.80it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.01it/s]
  4%|▍         | 9/200 [00:01<00:31,  6.15it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.69it/s]
  6%|▌         | 12/200 [00:02<00:27,  6.82it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.90it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.98it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.08it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.16it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.19it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.27it/s]
 10%|▉         | 19/200 [00:03<00:24,  7.34it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.44it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.83it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:05<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:05<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.81it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:06<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:06<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.07it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:07<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.21it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.24it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.25it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.25it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:08<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.23it/s]
 30%|███       | 61/200 [00:08<00:16,  8.23it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.44it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.55it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.72it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:09<00:14,  8.90it/s]
 34%|███▍      | 68/200 [00:09<00:14,  8.97it/s]
 34%|███▍      | 69/200 [00:09<00:14,  9.03it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.10it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.13it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.14it/s]
 38%|███▊      | 77/200 [00:10<00:13,  9.21it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.19it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.28it/s]
 40%|████      | 80/200 [00:10<00:12,  9.35it/s]
 40%|████      | 81/200 [00:10<00:12,  9.35it/s]
 41%|████      | 82/200 [00:10<00:12,  9.37it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.39it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.39it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.40it/s]
 43%|████▎     | 86/200 [00:11<00:12,  9.42it/s]
 44%|████▎     | 87/200 [00:11<00:11,  9.43it/s]
 44%|████▍     | 88/200 [00:11<00:11,  9.44it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.50it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.53it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.48it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.44it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.48it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.55it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.62it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.65it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.65it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.70it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.72it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.75it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.77it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.80it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.81it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.81it/s]
 52%|█████▎    | 105/200 [00:13<00:09,  9.80it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.95it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:14<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.02it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.02it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.20it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.25it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.23it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.32it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.36it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.42it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.48it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.57it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.63it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.67it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.75it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.79it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.82it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.88it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.92it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.94it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.90it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.93it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.32it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.62it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.85it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 12.00it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 12.10it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.17it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.35it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.48it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.63it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.79it/s]
 91%|█████████ | 182/200 [00:20<00:01, 13.00it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.24it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.54it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.88it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.24it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.55it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.86it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.26it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.55it/s]
100%|██████████| 200/200 [00:21<00:00, 15.76it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:08:13,488 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:08:27,846 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:08:27,899 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
int8 baseline

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:52,  3.82it/s]
  1%|          | 2/200 [00:00<00:43,  4.58it/s]
  2%|▏         | 3/200 [00:00<00:40,  4.91it/s]
  2%|▏         | 4/200 [00:00<00:38,  5.09it/s]
  2%|▎         | 5/200 [00:01<00:37,  5.18it/s]
  3%|▎         | 6/200 [00:01<00:37,  5.22it/s]
  4%|▎         | 7/200 [00:01<00:36,  5.27it/s]
  4%|▍         | 8/200 [00:01<00:36,  5.31it/s]
  4%|▍         | 9/200 [00:01<00:35,  5.34it/s]
  5%|▌         | 10/200 [00:01<00:35,  5.40it/s]
  6%|▌         | 11/200 [00:02<00:34,  5.43it/s]
  6%|▌         | 12/200 [00:02<00:34,  5.46it/s]
  6%|▋         | 13/200 [00:02<00:34,  5.49it/s]
  7%|▋         | 14/200 [00:02<00:33,  5.51it/s]
  8%|▊         | 15/200 [00:02<00:33,  5.53it/s]
  8%|▊         | 16/200 [00:03<00:33,  5.53it/s]
  8%|▊         | 17/200 [00:03<00:33,  5.52it/s]
  9%|▉         | 18/200 [00:03<00:32,  5.53it/s]
 10%|▉         | 19/200 [00:03<00:32,  5.54it/s]
 10%|█         | 20/200 [00:03<00:32,  5.55it/s]
 10%|█         | 21/200 [00:03<00:32,  5.55it/s]
 11%|█         | 22/200 [00:04<00:32,  5.55it/s]
 12%|█▏        | 23/200 [00:04<00:31,  5.54it/s]
 12%|█▏        | 24/200 [00:04<00:31,  5.54it/s]
 12%|█▎        | 25/200 [00:04<00:31,  5.55it/s]
 13%|█▎        | 26/200 [00:04<00:31,  5.56it/s]
 14%|█▎        | 27/200 [00:04<00:31,  5.56it/s]
 14%|█▍        | 28/200 [00:05<00:30,  5.55it/s]
 14%|█▍        | 29/200 [00:05<00:30,  5.55it/s]
 15%|█▌        | 30/200 [00:05<00:30,  5.55it/s]
 16%|█▌        | 31/200 [00:05<00:30,  5.56it/s]
 16%|█▌        | 32/200 [00:05<00:30,  5.55it/s]
 16%|█▋        | 33/200 [00:06<00:30,  5.55it/s]
 17%|█▋        | 34/200 [00:06<00:29,  5.55it/s]
 18%|█▊        | 35/200 [00:06<00:29,  5.55it/s]
 18%|█▊        | 36/200 [00:06<00:29,  5.55it/s]
 18%|█▊        | 37/200 [00:06<00:29,  5.55it/s]
 19%|█▉        | 38/200 [00:06<00:29,  5.55it/s]
 20%|█▉        | 39/200 [00:07<00:28,  5.55it/s]
 20%|██        | 40/200 [00:07<00:28,  5.56it/s]
 20%|██        | 41/200 [00:07<00:28,  5.56it/s]
 21%|██        | 42/200 [00:07<00:28,  5.56it/s]
 22%|██▏       | 43/200 [00:07<00:28,  5.56it/s]
 22%|██▏       | 44/200 [00:08<00:28,  5.56it/s]
 22%|██▎       | 45/200 [00:08<00:27,  5.56it/s]
 23%|██▎       | 46/200 [00:08<00:27,  5.56it/s]
 24%|██▎       | 47/200 [00:08<00:27,  5.56it/s]
 24%|██▍       | 48/200 [00:08<00:27,  5.58it/s]
 24%|██▍       | 49/200 [00:08<00:27,  5.59it/s]
 25%|██▌       | 50/200 [00:09<00:26,  5.60it/s]
 26%|██▌       | 51/200 [00:09<00:26,  5.60it/s]
 26%|██▌       | 52/200 [00:09<00:26,  5.60it/s]
 26%|██▋       | 53/200 [00:09<00:26,  5.61it/s]
 27%|██▋       | 54/200 [00:09<00:26,  5.61it/s]
 28%|██▊       | 55/200 [00:10<00:25,  5.61it/s]
 28%|██▊       | 56/200 [00:10<00:25,  5.61it/s]
 28%|██▊       | 57/200 [00:10<00:25,  5.61it/s]
 29%|██▉       | 58/200 [00:10<00:25,  5.60it/s]
 30%|██▉       | 59/200 [00:10<00:25,  5.60it/s]
 30%|███       | 60/200 [00:10<00:24,  5.60it/s]
 30%|███       | 61/200 [00:11<00:24,  5.60it/s]
 31%|███       | 62/200 [00:11<00:24,  5.61it/s]
 32%|███▏      | 63/200 [00:11<00:24,  5.61it/s]
 32%|███▏      | 64/200 [00:11<00:24,  5.61it/s]
 32%|███▎      | 65/200 [00:11<00:24,  5.62it/s]
 33%|███▎      | 66/200 [00:11<00:23,  5.62it/s]
 34%|███▎      | 67/200 [00:12<00:23,  5.62it/s]
 34%|███▍      | 68/200 [00:12<00:23,  5.62it/s]
 34%|███▍      | 69/200 [00:12<00:23,  5.62it/s]
 35%|███▌      | 70/200 [00:12<00:23,  5.61it/s]
 36%|███▌      | 71/200 [00:12<00:22,  5.61it/s]
 36%|███▌      | 72/200 [00:13<00:22,  5.62it/s]
 36%|███▋      | 73/200 [00:13<00:22,  5.62it/s]
 37%|███▋      | 74/200 [00:13<00:22,  5.62it/s]
 38%|███▊      | 75/200 [00:13<00:22,  5.62it/s]
 38%|███▊      | 76/200 [00:13<00:22,  5.62it/s]
 38%|███▊      | 77/200 [00:13<00:21,  5.62it/s]
 39%|███▉      | 78/200 [00:14<00:21,  5.62it/s]
 40%|███▉      | 79/200 [00:14<00:21,  5.62it/s]
 40%|████      | 80/200 [00:14<00:21,  5.62it/s]
 40%|████      | 81/200 [00:14<00:21,  5.62it/s]
 41%|████      | 82/200 [00:14<00:20,  5.62it/s]
 42%|████▏     | 83/200 [00:15<00:20,  5.62it/s]
 42%|████▏     | 84/200 [00:15<00:20,  5.62it/s]
 42%|████▎     | 85/200 [00:15<00:20,  5.63it/s]
 43%|████▎     | 86/200 [00:15<00:20,  5.63it/s]
 44%|████▎     | 87/200 [00:15<00:20,  5.62it/s]
 44%|████▍     | 88/200 [00:15<00:19,  5.63it/s]
 44%|████▍     | 89/200 [00:16<00:19,  5.63it/s]
 45%|████▌     | 90/200 [00:16<00:19,  5.64it/s]
 46%|████▌     | 91/200 [00:16<00:19,  5.65it/s]
 46%|████▌     | 92/200 [00:16<00:19,  5.65it/s]
 46%|████▋     | 93/200 [00:16<00:18,  5.65it/s]
 47%|████▋     | 94/200 [00:16<00:18,  5.65it/s]
 48%|████▊     | 95/200 [00:17<00:18,  5.65it/s]
 48%|████▊     | 96/200 [00:17<00:18,  5.66it/s]
 48%|████▊     | 97/200 [00:17<00:18,  5.66it/s]
 49%|████▉     | 98/200 [00:17<00:18,  5.66it/s]
 50%|████▉     | 99/200 [00:17<00:17,  5.65it/s]
 50%|█████     | 100/200 [00:18<00:17,  5.65it/s]
 50%|█████     | 101/200 [00:18<00:17,  5.66it/s]
 51%|█████     | 102/200 [00:18<00:17,  5.65it/s]
 52%|█████▏    | 103/200 [00:18<00:17,  5.66it/s]
 52%|█████▏    | 104/200 [00:18<00:16,  5.66it/s]
 52%|█████▎    | 105/200 [00:18<00:16,  5.66it/s]
 53%|█████▎    | 106/200 [00:19<00:16,  5.66it/s]
 54%|█████▎    | 107/200 [00:19<00:16,  5.66it/s]
 54%|█████▍    | 108/200 [00:19<00:16,  5.66it/s]
 55%|█████▍    | 109/200 [00:19<00:16,  5.66it/s]
 55%|█████▌    | 110/200 [00:19<00:15,  5.66it/s]
 56%|█████▌    | 111/200 [00:19<00:15,  5.66it/s]
 56%|█████▌    | 112/200 [00:20<00:15,  5.67it/s]
 56%|█████▋    | 113/200 [00:20<00:15,  5.67it/s]
 57%|█████▋    | 114/200 [00:20<00:15,  5.67it/s]
 57%|█████▊    | 115/200 [00:20<00:15,  5.67it/s]
 58%|█████▊    | 116/200 [00:20<00:14,  5.66it/s]
 58%|█████▊    | 117/200 [00:21<00:14,  5.67it/s]
 59%|█████▉    | 118/200 [00:21<00:14,  5.67it/s]
 60%|█████▉    | 119/200 [00:21<00:14,  5.67it/s]
 60%|██████    | 120/200 [00:21<00:14,  5.66it/s]
 60%|██████    | 121/200 [00:21<00:13,  5.66it/s]
 61%|██████    | 122/200 [00:21<00:13,  5.67it/s]
 62%|██████▏   | 123/200 [00:22<00:13,  5.67it/s]
 62%|██████▏   | 124/200 [00:22<00:13,  5.67it/s]
 62%|██████▎   | 125/200 [00:22<00:13,  5.67it/s]
 63%|██████▎   | 126/200 [00:22<00:13,  5.66it/s]
 64%|██████▎   | 127/200 [00:22<00:12,  5.66it/s]
 64%|██████▍   | 128/200 [00:22<00:12,  5.67it/s]
 64%|██████▍   | 129/200 [00:23<00:12,  5.67it/s]
 65%|██████▌   | 130/200 [00:23<00:12,  5.67it/s]
 66%|██████▌   | 131/200 [00:23<00:12,  5.67it/s]
 66%|██████▌   | 132/200 [00:23<00:12,  5.67it/s]
 66%|██████▋   | 133/200 [00:23<00:11,  5.67it/s]
 67%|██████▋   | 134/200 [00:24<00:11,  5.67it/s]
 68%|██████▊   | 135/200 [00:24<00:11,  5.68it/s]
 68%|██████▊   | 136/200 [00:24<00:11,  5.67it/s]
 68%|██████▊   | 137/200 [00:24<00:11,  5.67it/s]
 69%|██████▉   | 138/200 [00:24<00:10,  5.67it/s]
 70%|██████▉   | 139/200 [00:24<00:10,  5.68it/s]
 70%|███████   | 140/200 [00:25<00:10,  5.68it/s]
 70%|███████   | 141/200 [00:25<00:10,  5.68it/s]
 71%|███████   | 142/200 [00:25<00:10,  5.68it/s]
 72%|███████▏  | 143/200 [00:25<00:10,  5.68it/s]
 72%|███████▏  | 144/200 [00:25<00:09,  5.67it/s]
 72%|███████▎  | 145/200 [00:25<00:09,  5.67it/s]
 73%|███████▎  | 146/200 [00:26<00:09,  5.67it/s]
 74%|███████▎  | 147/200 [00:26<00:09,  5.67it/s]
 74%|███████▍  | 148/200 [00:26<00:09,  5.67it/s]
 74%|███████▍  | 149/200 [00:26<00:08,  5.67it/s]
 75%|███████▌  | 150/200 [00:26<00:08,  5.67it/s]
 76%|███████▌  | 151/200 [00:27<00:08,  5.67it/s]
 76%|███████▌  | 152/200 [00:27<00:08,  5.67it/s]
 76%|███████▋  | 153/200 [00:27<00:08,  5.67it/s]
 77%|███████▋  | 154/200 [00:27<00:08,  5.68it/s]
 78%|███████▊  | 155/200 [00:27<00:07,  5.68it/s]
 78%|███████▊  | 156/200 [00:27<00:07,  5.68it/s]
 78%|███████▊  | 157/200 [00:28<00:07,  5.68it/s]
 79%|███████▉  | 158/200 [00:28<00:07,  5.68it/s]
 80%|███████▉  | 159/200 [00:28<00:07,  5.68it/s]
 80%|████████  | 160/200 [00:28<00:07,  5.69it/s]
 80%|████████  | 161/200 [00:28<00:06,  5.65it/s]
 81%|████████  | 162/200 [00:28<00:06,  5.66it/s]
 82%|████████▏ | 163/200 [00:29<00:06,  5.66it/s]
 82%|████████▏ | 164/200 [00:29<00:06,  5.66it/s]
 82%|████████▎ | 165/200 [00:29<00:06,  5.67it/s]
 83%|████████▎ | 166/200 [00:29<00:05,  5.67it/s]
 84%|████████▎ | 167/200 [00:29<00:05,  5.68it/s]
 84%|████████▍ | 168/200 [00:30<00:05,  5.68it/s]
 84%|████████▍ | 169/200 [00:30<00:05,  5.68it/s]
 85%|████████▌ | 170/200 [00:30<00:05,  5.68it/s]
 86%|████████▌ | 171/200 [00:30<00:05,  5.68it/s]
 86%|████████▌ | 172/200 [00:30<00:04,  5.68it/s]
 86%|████████▋ | 173/200 [00:30<00:04,  5.68it/s]
 87%|████████▋ | 174/200 [00:31<00:04,  5.68it/s]
 88%|████████▊ | 175/200 [00:31<00:04,  5.68it/s]
 88%|████████▊ | 176/200 [00:31<00:04,  5.68it/s]
 88%|████████▊ | 177/200 [00:31<00:04,  5.69it/s]
 89%|████████▉ | 178/200 [00:31<00:03,  5.69it/s]
 90%|████████▉ | 179/200 [00:31<00:03,  5.69it/s]
 90%|█████████ | 180/200 [00:32<00:03,  5.69it/s]
 90%|█████████ | 181/200 [00:32<00:03,  5.70it/s]
 91%|█████████ | 182/200 [00:32<00:03,  5.70it/s]
 92%|█████████▏| 183/200 [00:32<00:02,  5.70it/s]
 92%|█████████▏| 184/200 [00:32<00:02,  5.70it/s]
 92%|█████████▎| 185/200 [00:33<00:02,  5.71it/s]
 93%|█████████▎| 186/200 [00:33<00:02,  5.71it/s]
 94%|█████████▎| 187/200 [00:33<00:02,  5.71it/s]
 94%|█████████▍| 188/200 [00:33<00:02,  5.72it/s]
 94%|█████████▍| 189/200 [00:33<00:01,  5.73it/s]
 95%|█████████▌| 190/200 [00:33<00:01,  5.74it/s]
 96%|█████████▌| 191/200 [00:34<00:01,  5.73it/s]
 96%|█████████▌| 192/200 [00:34<00:01,  5.73it/s]
 96%|█████████▋| 193/200 [00:34<00:01,  5.74it/s]
 97%|█████████▋| 194/200 [00:34<00:01,  5.74it/s]
 98%|█████████▊| 195/200 [00:34<00:00,  5.75it/s]
 98%|█████████▊| 196/200 [00:34<00:00,  5.75it/s]
 98%|█████████▊| 197/200 [00:35<00:00,  5.75it/s]
 99%|█████████▉| 198/200 [00:35<00:00,  5.73it/s]
100%|█████████▉| 199/200 [00:35<00:00,  5.73it/s]
100%|██████████| 200/200 [00:35<00:00,  5.72it/s]
100%|██████████| 200/200 [00:35<00:00,  5.62it/s]
2024-12-18:22:09:03,764 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:09:18,391 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:09:18,444 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 74.0

Testing individual layer upgrades...

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.63it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.75it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:21,  7.82it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.82it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.86it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.86it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.86it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.87it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.88it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.92it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.01it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.21it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.25it/s]
 30%|███       | 60/200 [00:08<00:17,  8.23it/s]
 30%|███       | 61/200 [00:08<00:16,  8.24it/s]
 31%|███       | 62/200 [00:08<00:16,  8.27it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.44it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.96it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.98it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.08it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.19it/s]
 40%|████      | 81/200 [00:10<00:12,  9.21it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.29it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.27it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.36it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.61it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.71it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.73it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.79it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.93it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.94it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.96it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.07it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.09it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.05it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.04it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.19it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.25it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.51it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.56it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.59it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.65it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.66it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.79it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.86it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.90it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.89it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.88it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.94it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.99it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.31it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.55it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.79it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.92it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.18it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.33it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.39it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.52it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.69it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.85it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.09it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.38it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.68it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.14it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.49it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.86it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.25it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.50it/s]
100%|██████████| 200/200 [00:21<00:00, 15.86it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:22:09:39,840 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:09:54,413 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:09:54,467 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.0.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.92it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.69it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.79it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.87it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.18it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.26it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.83it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.89it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.87it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.97it/s]
 20%|██        | 41/200 [00:05<00:19,  8.00it/s]
 21%|██        | 42/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.21it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.81it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.98it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.07it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.09it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.21it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.29it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.37it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.53it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.69it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.73it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.76it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.80it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.72it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.02it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.11it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.21it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.25it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.37it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.48it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.53it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.58it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.70it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.92it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.93it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.25it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.54it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.81it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.99it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.10it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.18it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.43it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.62it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.74it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.90it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.14it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.35it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.71it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.10it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.47it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.75it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.16it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00, 15.78it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:10:15,905 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:10:30,394 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:10:30,447 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 72.0
Results for layer: layers.0.attention.wo
Accuracy: 72.0
Improvement over INT4 baseline: 4.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.48it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.77it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.25it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.44it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.69it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.71it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.79it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.75it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.74it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.82it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.85it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:20,  7.90it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:19,  8.04it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.10it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.10it/s]
 27%|██▋       | 54/200 [00:07<00:18,  8.10it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.14it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.15it/s]
 30%|███       | 60/200 [00:08<00:17,  8.11it/s]
 30%|███       | 61/200 [00:08<00:17,  8.13it/s]
 31%|███       | 62/200 [00:08<00:16,  8.14it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.31it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.73it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.82it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.86it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.00it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.15it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.17it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.11it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.27it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.27it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.36it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 96/200 [00:12<00:11,  9.45it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.54it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.61it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.68it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.03it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.05it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.08it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.10it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.13it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.12it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.19it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.26it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.31it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.39it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.39it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.47it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.44it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.52it/s]
 74%|███████▎  | 147/200 [00:17<00:05, 10.58it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.61it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.71it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.77it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.80it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.00it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.29it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.49it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.71it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.86it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 11.97it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.11it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.39it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.64it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.65it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 12.99it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.25it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.69it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.06it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.38it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.77it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.04it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.31it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:10:52,048 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:11:06,586 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:11:06,640 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.0.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.51it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.92it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.68it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.73it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.74it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.78it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.81it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.85it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.07it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.09it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.97it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.04it/s]
 40%|████      | 80/200 [00:10<00:13,  9.08it/s]
 40%|████      | 81/200 [00:10<00:13,  9.13it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.26it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.49it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.54it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.99it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.03it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.06it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.08it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.10it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.09it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.10it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.12it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.19it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.28it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.47it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.55it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.60it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.68it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.97it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.29it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.56it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.89it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 11.97it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.13it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.42it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.46it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.59it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.72it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.04it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.35it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.80it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.20it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.49it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.81it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.05it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.40it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:22:11:28,182 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:11:42,726 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:11:42,779 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.0.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.68it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.73it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:22,  7.72it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:20,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.05it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.14it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.33it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.72it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.23it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.23it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.88it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.89it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.89it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.90it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.97it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.97it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.97it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.98it/s]
 60%|██████    | 120/200 [00:14<00:08,  9.97it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.05it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.18it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.27it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.51it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.56it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.54it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.78it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.81it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.44it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.82it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.95it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.05it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.31it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.46it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.62it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.79it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.04it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.34it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.62it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.01it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.33it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.70it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.03it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.37it/s]
100%|██████████| 200/200 [00:21<00:00, 15.62it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:22:12:04,316 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:12:18,835 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:12:18,888 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.0.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.60it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.81it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.96it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.12it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.42it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.20it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.21it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.31it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.63it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.70it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.90it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.07it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.08it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.15it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.23it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.32it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.51it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.57it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.59it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.63it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.70it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.75it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.79it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.88it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.86it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.91it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.08it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.32it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.59it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.81it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.97it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.09it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.21it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.31it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.43it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.75it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.84it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.21it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.44it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.89it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.23it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.56it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.95it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.21it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.60it/s]
100%|██████████| 200/200 [00:21<00:00,  9.47it/s]
2024-12-18:22:12:40,372 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:12:54,840 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:12:54,893 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 72.0
Results for layer: layers.1.attention.wqkv
Accuracy: 72.0
Improvement over INT4 baseline: 4.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:37,  5.35it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.53it/s]
 11%|█         | 22/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.64it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.75it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.97it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.19it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.70it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.23it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.32it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.50it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.70it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.75it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.78it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.80it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.82it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.93it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.01it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.04it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.14it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.24it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.34it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.48it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.57it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.62it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.69it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.83it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.86it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.89it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.08it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.40it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.68it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.90it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.17it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.39it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.54it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.66it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.84it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 13.00it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.29it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.44it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.97it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.28it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.66it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.95it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.28it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.69it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:13:16,341 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:13:30,912 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:13:30,965 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.1.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.17it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.22it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.91it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.12it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.09it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.16it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.72it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.98it/s]
 37%|███▋      | 74/200 [00:09<00:14,  9.00it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.06it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.25it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.21it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.36it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.59it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.66it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.63it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.68it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.72it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.04it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.06it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.21it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.36it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.49it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.52it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.71it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.83it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.87it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.43it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.63it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.96it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.37it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.59it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.68it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.91it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.20it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.56it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.97it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.27it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.63it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.93it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.28it/s]
100%|██████████| 200/200 [00:21<00:00, 15.58it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:13:52,510 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:14:07,780 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:14:07,833 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.1.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.97it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.01it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.13it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.17it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.79it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.94it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.03it/s]
 40%|████      | 80/200 [00:10<00:13,  9.10it/s]
 40%|████      | 81/200 [00:10<00:13,  9.15it/s]
 41%|████      | 82/200 [00:10<00:12,  9.12it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.16it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.27it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.48it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.08it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.09it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.10it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.11it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.10it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.17it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.26it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.29it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.41it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.48it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.53it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.60it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.65it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.76it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.01it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.29it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.52it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.89it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.01it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.13it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.41it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.53it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.66it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.74it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.10it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.39it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.83it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.19it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.48it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.77it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.08it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:14:29,375 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:14:44,673 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:14:44,728 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.1.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.47it/s]
  1%|          | 2/200 [00:00<00:36,  5.35it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.86it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.97it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.20it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.69it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.98it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.75it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.84it/s]
 20%|██        | 40/200 [00:05<00:20,  7.91it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.07it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.11it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.14it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.59it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.97it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.98it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.05it/s]
 40%|████      | 80/200 [00:10<00:13,  9.10it/s]
 40%|████      | 81/200 [00:10<00:13,  9.12it/s]
 41%|████      | 82/200 [00:10<00:12,  9.12it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.15it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.23it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.50it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.61it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.76it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.89it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.84it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.79it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.89it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.96it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.97it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.97it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.96it/s]
 60%|██████    | 120/200 [00:14<00:08,  9.98it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.04it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.05it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.14it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.25it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.44it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.50it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.66it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.74it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.78it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.80it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.17it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.37it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.64it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.05it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.12it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.22it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.36it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.48it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.72it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.00it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.25it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.59it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.94it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.30it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.63it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.99it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.29it/s]
100%|██████████| 200/200 [00:21<00:00, 15.56it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:15:06,314 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:15:21,538 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:15:21,592 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 74.0
Results for layer: layers.1.feed_forward.w2
Accuracy: 74.0
Improvement over INT4 baseline: 6.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.62it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.75it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.01it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.12it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.43it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.78it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.25it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.66it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.84it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.94it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.10it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.11it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.08it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.06it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.11it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.19it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.27it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.50it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.57it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.59it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.59it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.58it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.81it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.82it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.81it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.87it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.91it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.22it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.71it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.92it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.15it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.17it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.29it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.39it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.53it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.77it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.03it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.31it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.65it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.06it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.37it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.69it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.12it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00, 15.80it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:22:15:43,051 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:15:58,357 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:15:58,410 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.2.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.25it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.80it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.86it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.17it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.27it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.63it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.71it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.74it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:21,  7.82it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.86it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.86it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.99it/s]
 20%|██        | 41/200 [00:05<00:19,  8.00it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.19it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.21it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.14it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.53it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.70it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.95it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.98it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.11it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.17it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.21it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.25it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.53it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.49it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.57it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.72it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.89it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.02it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.17it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.23it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.32it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.45it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.48it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.54it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.56it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.65it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.72it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.76it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.81it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.83it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.88it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.90it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.06it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.41it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.68it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.90it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.15it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.36it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.52it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.67it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.83it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.98it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.22it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.42it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.93it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.31it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.62it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.98it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.33it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.68it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:16:19,838 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:16:35,063 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:16:35,116 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.2.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.67it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.11it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.85it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.97it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.06it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.15it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:24,  7.42it/s]
 11%|█         | 22/200 [00:03<00:23,  7.52it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.51it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.60it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.72it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.72it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.81it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.09it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.09it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.13it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.43it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.70it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.81it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.83it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.02it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.03it/s]
 40%|████      | 80/200 [00:10<00:13,  9.10it/s]
 40%|████      | 81/200 [00:10<00:13,  9.13it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.20it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.18it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.15it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.16it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.13it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.20it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.24it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.54it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.53it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.68it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.66it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.83it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.00it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.02it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.05it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.16it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.24it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.23it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.30it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.43it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.48it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.49it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.57it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.66it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.69it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.77it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.78it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.12it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.38it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.63it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.82it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.92it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.02it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.20it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.32it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.40it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.50it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.66it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.91it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.12it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.52it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.89it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.21it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.58it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.84it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.19it/s]
100%|██████████| 200/200 [00:21<00:00, 15.49it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:16:56,701 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:17:11,862 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:17:11,915 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.2.feed_forward.w1
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.43it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.58it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.20it/s]
 10%|█         | 20/200 [00:03<00:24,  7.35it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.52it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.74it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.91it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.07it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.11it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.13it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.14it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.30it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.81it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.91it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.94it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.97it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.93it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.98it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.00it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.09it/s]
 40%|████      | 81/200 [00:10<00:13,  9.07it/s]
 41%|████      | 82/200 [00:10<00:12,  9.13it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.11it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.16it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.12it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.19it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.21it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.24it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.49it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.66it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.00it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.06it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.06it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.11it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.22it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.24it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.23it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.36it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.48it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.52it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.58it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.75it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.75it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.79it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.82it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.98it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.24it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.51it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.90it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.01it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.06it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.21it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.34it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.43it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.60it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.73it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.06it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.32it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.81it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.19it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.51it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.85it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.07it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.42it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:17:33,493 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:17:48,702 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:17:48,756 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.2.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.47it/s]
  1%|          | 2/200 [00:00<00:37,  5.34it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.51it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.85it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.97it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.20it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.44it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.60it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.70it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.76it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.01it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.10it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.15it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.11it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.14it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.57it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.71it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.81it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.96it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.12it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.20it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.25it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.59it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.66it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.66it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.92it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.93it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.04it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.03it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.06it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.16it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.30it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.42it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.48it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.66it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.79it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.80it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.39it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.64it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.96it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.01it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.14it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.23it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.39it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.47it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.72it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.93it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.21it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.53it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.93it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.25it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.60it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.99it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.23it/s]
100%|██████████| 200/200 [00:21<00:00, 15.57it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:18:10,326 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:18:25,601 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:18:25,655 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.2.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.05it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:18,  8.10it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.72it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.28it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.27it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.70it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.76it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.77it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.88it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.01it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.12it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.22it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.33it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.45it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.51it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.59it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.61it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.64it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.71it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.75it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.79it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.79it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.90it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.91it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.91it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.05it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.31it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.60it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.82it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.97it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.08it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.18it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.48it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.61it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.73it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.86it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.18it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.44it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.89it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.27it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.63it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.94it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.26it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.53it/s]
100%|██████████| 200/200 [00:21<00:00,  9.47it/s]
2024-12-18:22:18:47,123 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:19:02,435 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:19:02,489 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.3.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.52it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.91it/s]
 21%|██        | 42/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.12it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.11it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.15it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.16it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:17,  8.15it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.06it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.09it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.06it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.19it/s]
 40%|████      | 81/200 [00:10<00:12,  9.25it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.25it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.27it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.32it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.53it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.70it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.75it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.76it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.76it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.78it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.87it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.02it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.16it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.23it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.34it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.45it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.46it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.52it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.49it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.56it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.65it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.69it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.75it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.79it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.84it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.88it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.08it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.39it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.65it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.87it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.02it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.13it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.18it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.39it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.73it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.87it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.15it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.36it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.87it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.23it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.61it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.98it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.31it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.65it/s]
100%|██████████| 200/200 [00:21<00:00,  9.47it/s]
2024-12-18:22:19:23,960 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:19:38,983 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:19:39,037 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.3.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.51it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.10it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.96it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.06it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.15it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.50it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.58it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:22,  7.72it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.73it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.78it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:21,  7.76it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.82it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.85it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.08it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.14it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:17,  8.16it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.44it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.96it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.95it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.11it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.19it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.17it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.22it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.50it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.55it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.46it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.63it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.83it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.87it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.02it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.19it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.31it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.36it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.40it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.44it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.45it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.49it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.56it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.64it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.79it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.78it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.84it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.14it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.40it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.65it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.94it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.02it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.20it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.30it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.41it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.50it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.65it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.91it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.12it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.49it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.92it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.26it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.57it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.86it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.21it/s]
100%|██████████| 200/200 [00:21<00:00, 15.50it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:20:00,634 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:20:16,015 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:20:16,067 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.3.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.15it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.25it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.69it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.72it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.74it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.97it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.12it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.11it/s]
 30%|███       | 60/200 [00:08<00:17,  8.12it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.81it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.25it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.54it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.65it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.88it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.00it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:08,  9.98it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.22it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.37it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.52it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.55it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.70it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.80it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.80it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.17it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.41it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.64it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.96it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.07it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.32it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.45it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.59it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.63it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.90it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.22it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.52it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.99it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.25it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.62it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.92it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.28it/s]
100%|██████████| 200/200 [00:21<00:00, 15.58it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:20:37,603 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:20:52,820 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:20:52,873 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.3.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.51it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.77it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.11it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.85it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.94it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.05it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.14it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.23it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:24,  7.42it/s]
 11%|█         | 22/200 [00:03<00:23,  7.50it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.61it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.72it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.79it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.77it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.12it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.08it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.12it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.16it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.81it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.97it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.97it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.00it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.09it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.17it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.26it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.48it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.62it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.00it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.04it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.05it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.09it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.14it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.14it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.21it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.29it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.40it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.47it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.51it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.54it/s]
 74%|███████▎  | 147/200 [00:17<00:05, 10.60it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.72it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.79it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.99it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.26it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.75it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.89it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.01it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.07it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.18it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.32it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.39it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.63it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.81it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.14it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.32it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.80it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.15it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.48it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.84it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.15it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:21:14,439 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:21:29,489 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:21:29,542 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.3.feed_forward.w2
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.78it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.25it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.64it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.83it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.87it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.33it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.70it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.81it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.94it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.97it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.09it/s]
 40%|████      | 81/200 [00:10<00:13,  9.15it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.27it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.37it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.74it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.79it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.81it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.95it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.02it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.00it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.01it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.14it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.23it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.31it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.45it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.52it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.57it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.57it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.63it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.68it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.74it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.80it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.87it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.90it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.03it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.34it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.59it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.83it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.00it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.09it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.39it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.73it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.82it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.11it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.41it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.85it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.20it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.62it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.95it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.24it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.59it/s]
100%|██████████| 200/200 [00:21<00:00,  9.47it/s]
2024-12-18:22:21:51,006 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:22:06,226 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:22:06,279 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.4.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.69it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.82it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.86it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.87it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.89it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.10it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.19it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.19it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.20it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.83it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.85it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.02it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.98it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.25it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.28it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.16it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.65it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.79it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.76it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.96it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.04it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.08it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.11it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.06it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.10it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.18it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.25it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.30it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.48it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.57it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.65it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.69it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.82it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.83it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.87it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.90it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.88it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.09it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.40it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.68it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.90it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.03it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.12it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.35it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.48it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.65it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.83it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.98it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.28it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.42it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.95it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.34it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.69it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.01it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.32it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.65it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:22:22:27,713 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:22:42,951 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:22:43,004 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.4.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.23it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.68it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.71it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.70it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.74it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.76it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.84it/s]
 20%|██        | 40/200 [00:05<00:20,  7.92it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.91it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.06it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.10it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.15it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.28it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.39it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.97it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.95it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.15it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.18it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.24it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.26it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.50it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.43it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.51it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.64it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.90it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.05it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.04it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.04it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.11it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.21it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.27it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.45it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.71it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.70it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.83it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.16it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.37it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.65it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.35it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.48it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.61it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.65it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.90it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.14it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.52it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.94it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.25it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.57it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.91it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.27it/s]
100%|██████████| 200/200 [00:21<00:00, 15.54it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:23:04,578 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:23:19,946 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:23:19,999 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.4.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.69it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.72it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.76it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.79it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.81it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.90it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.10it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.13it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.12it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.16it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.69it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.81it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.96it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.06it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.03it/s]
 40%|████      | 81/200 [00:10<00:13,  9.09it/s]
 41%|████      | 82/200 [00:10<00:12,  9.13it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.13it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.19it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.19it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.19it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.24it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.23it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.25it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.27it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.89it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.94it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.91it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.92it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.98it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.96it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.94it/s]
 60%|██████    | 121/200 [00:14<00:07,  9.98it/s]
 61%|██████    | 122/200 [00:14<00:07,  9.96it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.07it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.19it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.23it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.31it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.40it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.48it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.68it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.71it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.77it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.16it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.35it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.63it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.82it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.03it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.12it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.24it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.36it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.46it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.64it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.89it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.07it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.39it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.91it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.24it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.59it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.92it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.29it/s]
100%|██████████| 200/200 [00:21<00:00, 15.50it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:23:41,582 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:23:56,843 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:23:56,896 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.4.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.47it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.67it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.77it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.97it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.20it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:24,  7.43it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.62it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.74it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.96it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.08it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.10it/s]
 30%|███       | 60/200 [00:08<00:17,  8.12it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.24it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.70it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.80it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:14,  9.00it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.97it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.06it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.62it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.94it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.04it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.06it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.07it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.16it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.31it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.42it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.49it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.66it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.75it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.76it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.76it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.84it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.41it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.65it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.93it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 11.99it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.26it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.38it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.51it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.72it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.93it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.25it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.55it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.96it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.31it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.60it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.02it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.25it/s]
100%|██████████| 200/200 [00:21<00:00, 15.57it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:24:18,458 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:24:33,562 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:24:33,616 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.4.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.76it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.55it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.96it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.12it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.19it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.28it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.76it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.76it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.92it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.01it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.06it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.09it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.07it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.06it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.09it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.18it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.27it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.32it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.41it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.51it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.56it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.58it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.60it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.62it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.79it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.82it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.80it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.85it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.91it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.95it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.23it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.73it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.92it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.15it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.37it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.52it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.68it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.76it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.02it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.29it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.64it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.06it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.42it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.80it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.15it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.46it/s]
100%|██████████| 200/200 [00:21<00:00, 15.77it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:22:24:55,060 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:25:10,145 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:25:10,199 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 72.0
Results for layer: layers.5.attention.wqkv
Accuracy: 72.0
Improvement over INT4 baseline: 4.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.86it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.74it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.79it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.89it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.19it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.24it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.25it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:17,  8.16it/s]
 31%|███       | 62/200 [00:08<00:16,  8.17it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.07it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.28it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.53it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.58it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.74it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.78it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.80it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.81it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.95it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.01it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.16it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.24it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.32it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.47it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.52it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.56it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.65it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.69it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.80it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.88it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.88it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.07it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.39it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.67it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.88it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.03it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.12it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.33it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.48it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.63it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.81it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.96it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.21it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.40it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.89it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.31it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.64it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.98it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.30it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.64it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:22:25:31,649 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:25:46,984 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:25:47,037 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.5.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.77it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.26it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.23it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.79it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.72it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.74it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.83it/s]
 20%|██        | 40/200 [00:05<00:20,  7.90it/s]
 20%|██        | 41/200 [00:05<00:20,  7.90it/s]
 21%|██        | 42/200 [00:05<00:20,  7.86it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:19,  8.04it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.09it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.10it/s]
 27%|██▋       | 54/200 [00:07<00:18,  8.11it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:17,  8.12it/s]
 31%|███       | 62/200 [00:08<00:16,  8.16it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.32it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.39it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.52it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.69it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.71it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.81it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.93it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.98it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.09it/s]
 40%|████      | 80/200 [00:10<00:13,  9.09it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.14it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.18it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.24it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.24it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.25it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.35it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.50it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.79it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.77it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.82it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.86it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.92it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.96it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.98it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 120/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 121/200 [00:14<00:07,  9.99it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.08it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.06it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.22it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.25it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.25it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.35it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.42it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.45it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.49it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.52it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.64it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.71it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.75it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.95it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.26it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.52it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.73it/s]
 84%|████████▍ | 169/200 [00:19<00:02, 11.84it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 11.96it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.10it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.39it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.61it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.76it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.02it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.29it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.77it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.09it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.44it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.75it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.05it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.38it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:26:08,634 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:26:23,871 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:26:23,923 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.5.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.23it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.91it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.12it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.11it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.12it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.15it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.55it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.70it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.79it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.96it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.97it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.92it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.95it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.96it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.98it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.06it/s]
 40%|████      | 80/200 [00:10<00:13,  9.11it/s]
 40%|████      | 81/200 [00:10<00:13,  9.11it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.20it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.19it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.15it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.24it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.26it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.54it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.87it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.96it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.21it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.25it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.46it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.49it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.61it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.67it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.72it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.76it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.79it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.16it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.37it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.64it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.81it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.96it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.04it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.14it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.25it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.37it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.49it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.66it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.93it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.22it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.51it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.94it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.23it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.61it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.00it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.27it/s]
100%|██████████| 200/200 [00:21<00:00, 15.58it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:26:45,492 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:27:00,788 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:27:00,841 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.5.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.77it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.97it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.10it/s]
 30%|███       | 60/200 [00:08<00:17,  8.11it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.61it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.76it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.84it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.02it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.09it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.20it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.32it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.25it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.45it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.54it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.63it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.80it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.94it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.07it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.10it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.22it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.30it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.41it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.49it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.50it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.59it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.70it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.78it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.80it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.84it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.44it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.61it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.82it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.31it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.44it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.60it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.69it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.97it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.26it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.58it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.99it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.28it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.63it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.94it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.28it/s]
100%|██████████| 200/200 [00:21<00:00, 15.57it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:27:22,385 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:27:37,602 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:27:37,654 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 72.0
Results for layer: layers.5.feed_forward.w2
Accuracy: 72.0
Improvement over INT4 baseline: 4.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.73it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.81it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.80it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.83it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.87it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.19it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.11it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.79it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.12it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:13,  9.14it/s]
 41%|████      | 82/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.54it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.59it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.62it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.54it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.80it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.08it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.09it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.10it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.09it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.11it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.16it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.27it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.40it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.46it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.57it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.60it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.64it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.76it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.80it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.87it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.88it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.90it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.24it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.48it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.73it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.86it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.00it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.12it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.38it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.48it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.54it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.75it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.02it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.33it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.70it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.04it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.41it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.71it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.09it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.40it/s]
100%|██████████| 200/200 [00:21<00:00, 15.75it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:22:27:59,111 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:28:14,261 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:28:14,313 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.6.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.29it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.69it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.76it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.83it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.86it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.87it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.85it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.88it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.88it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.88it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.92it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.01it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.14it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.19it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:17,  8.15it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.07it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.09it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.28it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.27it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.36it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.25it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.72it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.74it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.76it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.95it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.02it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.04it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.13it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.23it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.31it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.49it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.54it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.56it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.60it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.62it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.67it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.76it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.82it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.83it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.86it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.89it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.09it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.42it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.68it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.88it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.01it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.12it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.37it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.49it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.63it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.77it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.92it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.21it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.40it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.93it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.33it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.66it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.98it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.32it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.68it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:28:35,742 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:28:50,962 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:28:51,015 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.6.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.60it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.91it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.07it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.11it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.14it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.15it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.31it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.61it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.70it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.05it/s]
 40%|████      | 80/200 [00:10<00:13,  9.11it/s]
 40%|████      | 81/200 [00:10<00:13,  9.13it/s]
 41%|████      | 82/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.19it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.20it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.16it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.18it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.24it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.46it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.53it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.64it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.68it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.99it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.01it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07,  9.99it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.05it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.14it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.24it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.25it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.31it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.37it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.46it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.45it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.50it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.58it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.59it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.81it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.79it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.84it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.12it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.39it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.66it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.82it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.86it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 11.99it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.18it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.56it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.66it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.91it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.18it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.51it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.93it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.28it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.61it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.85it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.21it/s]
100%|██████████| 200/200 [00:21<00:00, 15.55it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:29:12,593 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:29:27,742 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:29:27,795 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.6.feed_forward.w1
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:37,  5.35it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.79it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.44it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.62it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.87it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.12it/s]
 30%|███       | 60/200 [00:08<00:17,  8.12it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.43it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.57it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.71it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.75it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.82it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.96it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.97it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:13,  9.14it/s]
 41%|████      | 82/200 [00:10<00:12,  9.13it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.09it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.18it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.27it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.26it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.32it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.69it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.66it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.81it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.88it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.94it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.04it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.12it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.22it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.28it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.43it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.50it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.52it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.55it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.60it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.70it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.77it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.79it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.86it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.13it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.38it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.63it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.80it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.95it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.35it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.56it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.69it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.95it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.20it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.61it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.02it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.30it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.64it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.05it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.32it/s]
100%|██████████| 200/200 [00:21<00:00, 15.59it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:29:49,352 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:30:04,621 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:30:04,675 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.6.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.15it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.26it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.69it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.01it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.11it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:17,  8.13it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.42it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.98it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.94it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.04it/s]
 40%|████      | 80/200 [00:10<00:13,  9.11it/s]
 40%|████      | 81/200 [00:10<00:13,  9.15it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.53it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.53it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.68it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.82it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.86it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.01it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.98it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 120/200 [00:14<00:08,  9.99it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.06it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.16it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.31it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.42it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.50it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.65it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.78it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.77it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.16it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.43it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.85it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.94it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.03it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.14it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.25it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.38it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.50it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.70it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.97it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.23it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.57it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.98it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.33it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.64it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.00it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.30it/s]
100%|██████████| 200/200 [00:21<00:00, 15.56it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:30:26,202 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:30:41,338 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:30:41,391 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.6.feed_forward.w2
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:37,  5.35it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.19it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.11it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.22it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.10it/s]
 31%|███       | 62/200 [00:08<00:16,  8.16it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.42it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.09it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.15it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.17it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.37it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.54it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.55it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.72it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.76it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.80it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.78it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.82it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.87it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.91it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.00it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.98it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.09it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.17it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.25it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.32it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.50it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.54it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.58it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.60it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.60it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.79it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.82it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.87it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.91it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.21it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.72it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.92it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 12.06it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.13it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.20it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.30it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.44it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.62it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.80it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.02it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.21it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.63it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.05it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.40it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.82it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.11it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.45it/s]
100%|██████████| 200/200 [00:21<00:00, 15.72it/s]
100%|██████████| 200/200 [00:21<00:00,  9.46it/s]
2024-12-18:22:31:02,890 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:31:18,210 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:31:18,263 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.7.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.79it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.83it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.20it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.14it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.21it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.95it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.28it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.53it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.59it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.63it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.55it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.71it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.78it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.79it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.03it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.08it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.11it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.10it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.08it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.13it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.19it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.26it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.31it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.50it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.58it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.64it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.71it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.77it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.82it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.89it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.89it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.07it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.39it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.67it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.90it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.05it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.15it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.38it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.53it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.67it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.85it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.97it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.26it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.46it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.96it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.29it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.70it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.04it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.35it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.68it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:31:39,698 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:31:54,940 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:31:54,994 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.7.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.69it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.22it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.63it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.68it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.73it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.74it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.85it/s]
 20%|██        | 40/200 [00:05<00:20,  7.91it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.91it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.07it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.08it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.11it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.08it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.11it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.14it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.15it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:17,  8.13it/s]
 31%|███       | 62/200 [00:08<00:16,  8.15it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.31it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.40it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.95it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.24it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.19it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.23it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.25it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.50it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.55it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.88it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.07it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.07it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.15it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.29it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.37it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.39it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.46it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.57it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.61it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.82it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.77it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.84it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.15it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.40it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.66it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.85it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.91it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.02it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.20it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.41it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.52it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.67it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.94it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.23it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.52it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.91it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.26it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.60it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.90it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.24it/s]
100%|██████████| 200/200 [00:21<00:00, 15.52it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:32:16,557 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:32:31,692 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:32:31,748 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.7.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.67it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.96it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.86it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.07it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.17it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:24,  7.42it/s]
 11%|█         | 22/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.52it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.62it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.78it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.77it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.96it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.08it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.13it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.13it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.13it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.15it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.33it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.61it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.71it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.96it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.06it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.11it/s]
 40%|████      | 81/200 [00:10<00:13,  9.14it/s]
 41%|████      | 82/200 [00:10<00:12,  9.13it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.15it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.20it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.21it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.23it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.24it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.26it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.35it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.50it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.62it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.69it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.88it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.02it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.05it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.13it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.23it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.24it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.40it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.47it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.52it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.54it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.74it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.75it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.74it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.85it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.99it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.24it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.52it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.92it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.03it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.14it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.31it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.45it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.63it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.79it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.09it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.29it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.80it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.12it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.48it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.85it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.17it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:32:53,327 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:33:08,550 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:33:08,604 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.7.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:37,  5.35it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.97it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.20it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.22it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.70it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.79it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.86it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.15it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.12it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.13it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.54it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.63it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.78it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.02it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.95it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.17it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.18it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.22it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.34it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.50it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.62it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.66it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.79it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.82it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.81it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.82it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.85it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.93it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.99it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.98it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.05it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.16it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.25it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.43it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.48it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.67it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.74it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.83it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.86it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.20it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.46it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.85it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.08it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.21it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.30it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.63it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.78it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.02it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.26it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.62it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.99it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.32it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.67it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.02it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.34it/s]
100%|██████████| 200/200 [00:21<00:00, 15.58it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:33:30,164 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:33:45,180 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:33:45,232 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.7.feed_forward.w2
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.25it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.98it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.07it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.17it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:24,  7.43it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.79it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.97it/s]
 21%|██        | 42/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.10it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.15it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.13it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.06it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.06it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.90it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.97it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.09it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.05it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.16it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.27it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.50it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.57it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.59it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.61it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.62it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.71it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.79it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.82it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.82it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.85it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.90it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.95it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.22it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.92it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.17it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.39it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.55it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.68it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.77it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.03it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.31it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.68it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.06it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.36it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.79it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.16it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.46it/s]
100%|██████████| 200/200 [00:21<00:00, 15.81it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:22:34:06,658 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:34:21,646 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:34:21,697 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.8.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.92it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.78it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.86it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.24it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.81it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.86it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.85it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.89it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.88it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.89it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.91it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.95it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.22it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.22it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.12it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.25it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.24it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.26it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.55it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.71it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.83it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.12it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.18it/s]
 40%|████      | 80/200 [00:10<00:13,  9.21it/s]
 40%|████      | 81/200 [00:10<00:12,  9.24it/s]
 41%|████      | 82/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.30it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.31it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.30it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:10<00:12,  9.30it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.38it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.38it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.59it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.76it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.88it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.04it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.09it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.08it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.09it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.18it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.24it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.31it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.42it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.48it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.57it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.63it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.68it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.82it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.87it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.90it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.09it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.42it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.69it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.90it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.04it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.15it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.39it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.53it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.67it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.83it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.95it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.26it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.41it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.91it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.32it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.69it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.00it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.33it/s]
100%|█████████▉| 199/200 [00:20<00:00, 15.65it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:22:34:43,090 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:34:58,069 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:34:58,120 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.8.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.68it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.23it/s]
 10%|█         | 20/200 [00:03<00:24,  7.36it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.70it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.07it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.08it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.12it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.57it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.63it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.75it/s]
 34%|███▍      | 68/200 [00:08<00:15,  8.76it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.86it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.91it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.92it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.96it/s]
 38%|███▊      | 75/200 [00:09<00:14,  8.92it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.00it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.09it/s]
 40%|████      | 80/200 [00:10<00:13,  9.13it/s]
 40%|████      | 81/200 [00:10<00:13,  9.08it/s]
 41%|████      | 82/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.07it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.10it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.10it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.18it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.21it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.27it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:12<00:11,  9.45it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.54it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.59it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.89it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.07it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.08it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.11it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.18it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.25it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.27it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.39it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.45it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.48it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.55it/s]
 74%|███████▎  | 147/200 [00:17<00:05, 10.59it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.73it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.83it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.88it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.04it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.31it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.77it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.91it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.40it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.53it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.66it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.69it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.03it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.23it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.68it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.04it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.38it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.78it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.07it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.37it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:35:19,670 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:35:34,704 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:35:34,756 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.8.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.67it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.15it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.26it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.51it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.61it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.73it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.72it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.77it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.82it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.10it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.98it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.16it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.49it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.72it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.78it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.99it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.05it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.05it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.04it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.07it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.20it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.51it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.55it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.56it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.61it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.75it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.79it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.84it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.16it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.41it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.81it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.07it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.34it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.57it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.71it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.94it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.20it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.57it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.99it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.31it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.65it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.01it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.30it/s]
100%|██████████| 200/200 [00:21<00:00, 15.61it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:22:35:56,265 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:36:11,299 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:36:11,351 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.8.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.86it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.20it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.44it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.59it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.69it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.23it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.69it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.79it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.76it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.09it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.11it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.79it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.95it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.95it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.99it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.17it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.11it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.16it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.15it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.46it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.63it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.70it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.72it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.04it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.06it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.07it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.16it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.25it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.32it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.44it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.48it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.50it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.61it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.64it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.75it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.78it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.79it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.83it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.41it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.85it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.96it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.21it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.31it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.48it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.63it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.75it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.00it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.28it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.57it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.00it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.26it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.60it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.97it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.30it/s]
100%|██████████| 200/200 [00:21<00:00, 15.68it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:36:32,882 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:36:47,850 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:36:47,902 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.8.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.61it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.79it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.14it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.16it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.26it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.07it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.19it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.32it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.36it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.65it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.71it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.61it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.78it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.90it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.08it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.11it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.11it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.08it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.12it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.17it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.41it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.50it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.58it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.60it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.64it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.66it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.73it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.81it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.84it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.83it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.88it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.87it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.89it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.95it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.26it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.48it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.95it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.08it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.18it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.43it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.57it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.64it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.84it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.10it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.36it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.72it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.08it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.44it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.75it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.12it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.52it/s]
100%|██████████| 200/200 [00:21<00:00, 15.85it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:37:09,321 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:37:24,248 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:37:24,299 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.9.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.92it/s]
  4%|▎         | 7/200 [00:01<00:31,  6.03it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.18it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.88it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.94it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.79it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.83it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.86it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.08it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.12it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.15it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.12it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 52/200 [00:07<00:17,  8.24it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.23it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.10it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.21it/s]
 30%|███       | 61/200 [00:08<00:16,  8.24it/s]
 31%|███       | 62/200 [00:08<00:16,  8.24it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.72it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.77it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.11it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.17it/s]
 40%|████      | 80/200 [00:10<00:13,  9.22it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.33it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.64it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.68it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.69it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.71it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.79it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.95it/s]
 55%|█████▍    | 109/200 [00:13<00:09, 10.00it/s]
 56%|█████▌    | 111/200 [00:13<00:08, 10.01it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.03it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.07it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.08it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.15it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.24it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.32it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.42it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.48it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.52it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.57it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.62it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.69it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.81it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.90it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.89it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.09it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.42it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.68it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.90it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.17it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.38it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.51it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.67it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.98it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.25it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.44it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.94it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.31it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.71it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.01it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.34it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.66it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:37:45,710 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:38:00,680 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:38:00,732 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.9.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.97it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.22it/s]
 10%|█         | 20/200 [00:03<00:24,  7.36it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.62it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.70it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.68it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.72it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.73it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.77it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.81it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.84it/s]
 20%|██        | 40/200 [00:05<00:20,  7.91it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.91it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.10it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.11it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.12it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.16it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.16it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.26it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.37it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.57it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.72it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.77it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.84it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.90it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.88it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.92it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.00it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.06it/s]
 40%|████      | 81/200 [00:10<00:13,  9.12it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.18it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.21it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.16it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.22it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.23it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.27it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.47it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.62it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.69it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.88it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.92it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.04it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.04it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.06it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.11it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.15it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.16it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.20it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.40it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.40it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.48it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.47it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.55it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.64it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.67it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.68it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.79it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.97it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.28it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.69it/s]
 84%|████████▍ | 169/200 [00:19<00:02, 11.87it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 11.99it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.12it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.44it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.65it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.78it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.03it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.32it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.80it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.11it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.46it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.75it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.04it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.42it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:38:22,305 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:38:37,274 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:38:37,325 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.9.feed_forward.w1
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.69it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.79it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.74it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.11it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.08it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.13it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.13it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.14it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.81it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.90it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.18it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.24it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.27it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.48it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.53it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.57it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.63it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.67it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.72it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.78it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.87it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.89it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.91it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.93it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.02it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.00it/s]
 60%|██████    | 121/200 [00:14<00:07,  9.99it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.05it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.12it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.24it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.25it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.27it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.41it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.50it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.49it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.53it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.57it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.64it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.75it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.79it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.04it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.31it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.93it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.05it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.19it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.31it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.43it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.64it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.79it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.10it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.38it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.83it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.23it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.51it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.81it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.11it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.42it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:38:58,874 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:39:13,830 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:39:13,881 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.9.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.60it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.74it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:17,  8.16it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.43it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.70it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.69it/s]
 34%|███▍      | 68/200 [00:08<00:15,  8.76it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.19it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.19it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.51it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.66it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.96it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.01it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.04it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.14it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.44it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.50it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.58it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.66it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.82it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.01it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.33it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.58it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.78it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.88it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.01it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.14it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.41it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.69it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.86it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.20it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.43it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.90it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.17it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.49it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.86it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.20it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.52it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:22:39:35,374 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:39:50,281 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:39:50,332 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.9.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.15it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.97it/s]
 21%|██        | 42/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.98it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.07it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.96it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.05it/s]
 40%|████      | 80/200 [00:10<00:13,  9.06it/s]
 40%|████      | 81/200 [00:10<00:13,  9.15it/s]
 41%|████      | 82/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.15it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.17it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.49it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.54it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.53it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.55it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.80it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.79it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.02it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.06it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.09it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.09it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.10it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.11it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.19it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.53it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.56it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.55it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.64it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.67it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.72it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.77it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.80it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.84it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.89it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.07it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.35it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.62it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.86it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.94it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.08it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.41it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.51it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.71it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.88it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.17it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.45it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.93it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.26it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.68it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.95it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.27it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.60it/s]
100%|██████████| 200/200 [00:21<00:00,  9.47it/s]
2024-12-18:22:40:11,782 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:40:26,754 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:40:26,805 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.10.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.92it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.97it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.07it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.75it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.82it/s]
 14%|█▍        | 28/200 [00:04<00:21,  7.84it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.88it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.88it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.88it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.02it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.19it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.24it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.24it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.23it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.21it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.24it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.24it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.23it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.53it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.83it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.96it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.96it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.99it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.02it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.13it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.54it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.72it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.76it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08, 10.00it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.02it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.03it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.04it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.19it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.24it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.35it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.48it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.50it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.55it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.56it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.66it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.73it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.79it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.89it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.90it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.92it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.09it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.37it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.66it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.89it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.05it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.16it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.38it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.52it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.57it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.81it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.98it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.26it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.44it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.96it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.30it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.67it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.05it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.32it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.70it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:40:48,224 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:41:03,192 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:41:03,243 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.10.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.91it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.01it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.00it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.05it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.13it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.12it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:17,  8.15it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.81it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.96it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.00it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.08it/s]
 40%|████      | 81/200 [00:10<00:13,  9.15it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.20it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.20it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.53it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.69it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.77it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08, 10.00it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.02it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.06it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.08it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.09it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.18it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.23it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.29it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.40it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.46it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.50it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.55it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.62it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.73it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.03it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.30it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.93it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.15it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.42it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.56it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.62it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.73it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.07it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.26it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.74it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.10it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.49it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.77it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.09it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.47it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:41:24,764 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:41:39,672 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:41:39,723 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.10.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.85it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.98it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.17it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:24,  7.40it/s]
 11%|█         | 22/200 [00:03<00:23,  7.51it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.74it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.73it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s]
 20%|██        | 40/200 [00:05<00:20,  7.87it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.13it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.12it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.59it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.72it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.72it/s]
 34%|███▍      | 68/200 [00:08<00:15,  8.78it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.86it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.97it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.97it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.12it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.12it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.17it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.15it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.18it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.23it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.23it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.27it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.36it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.55it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.62it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.96it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.10it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.21it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.50it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.52it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.61it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.75it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.75it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.80it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.17it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.41it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.61it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.08it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.35it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.59it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.76it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.01it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.28it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.59it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.97it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.23it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.61it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.90it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.30it/s]
100%|██████████| 200/200 [00:21<00:00, 15.57it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:42:01,270 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:42:16,143 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:42:16,193 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.10.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.20it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.72it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.89it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.00it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.12it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.15it/s]
 31%|███       | 62/200 [00:08<00:16,  8.17it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.32it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.44it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.95it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:13,  9.10it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.20it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.17it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.23it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.52it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.65it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.81it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.85it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.06it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.05it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.10it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.18it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.26it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.32it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.44it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.55it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.62it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.67it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.83it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.03it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.34it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.60it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.80it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.92it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.11it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.36it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.40it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.62it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.82it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.14it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.40it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.86it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.15it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.47it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.82it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.18it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:42:37,717 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:42:54,916 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:42:54,966 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 72.0
Results for layer: layers.10.feed_forward.w2
Accuracy: 72.0
Improvement over INT4 baseline: 4.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.77it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.83it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.07it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.11it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.13it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.42it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.05it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.18it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.28it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.29it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.19it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.76it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.76it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.85it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.81it/s]
 56%|█████▌    | 111/200 [00:13<00:09,  9.88it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.96it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.98it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.21it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.28it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.41it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.53it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.55it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.56it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.60it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.64it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.75it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.81it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.84it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.81it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.88it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.89it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.45it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.72it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.93it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.07it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.15it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.36it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.56it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.71it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.78it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.05it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.30it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.65it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.07it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.37it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.79it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.16it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00, 15.73it/s]
100%|██████████| 200/200 [00:21<00:00,  9.47it/s]
2024-12-18:22:43:16,416 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:43:31,212 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:43:31,262 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.11.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.50it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.66it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.77it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.96it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.10it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.85it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:24,  7.41it/s]
 11%|█         | 22/200 [00:03<00:23,  7.52it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.97it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.10it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:17,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.71it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.82it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.18it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.54it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.71it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.76it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.81it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.80it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.85it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.94it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.94it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.00it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.98it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.98it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.03it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.17it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.46it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.51it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.58it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.67it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.73it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.75it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.80it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.85it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.87it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.86it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.25it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.51it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.94it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 12.08it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.16it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.41it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.52it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.64it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.85it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.01it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.27it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.68it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.14it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.42it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.80it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.18it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00, 15.82it/s]
100%|██████████| 200/200 [00:21<00:00,  9.46it/s]
2024-12-18:22:43:52,742 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:44:07,675 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:44:07,724 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.11.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.84it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:20,  7.91it/s]
 21%|██        | 42/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.01it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.01it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.13it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:17,  8.15it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.98it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.12it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.18it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.17it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.49it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.81it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.02it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.12it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.21it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.30it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.40it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.46it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.53it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.58it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.68it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.82it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.85it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.86it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.44it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.70it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.08it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.38it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.54it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.71it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.97it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.25it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.54it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.94it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.27it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.65it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.00it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.28it/s]
100%|██████████| 200/200 [00:21<00:00, 15.65it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:44:29,234 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:44:44,070 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:44:44,120 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.11.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.17it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.68it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.08it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.10it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.71it/s]
 34%|███▍      | 68/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.87it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.98it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.00it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.18it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.18it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.21it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.15it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.21it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.25it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.36it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.47it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.77it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.82it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.86it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.91it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.92it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.98it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.13it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.18it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.27it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.46it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.52it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.58it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.64it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.67it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.78it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.81it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.16it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.40it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.87it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.00it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.17it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.29it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.44it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.55it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.71it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.92it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.25it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.52it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.90it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.28it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.69it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.02it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.25it/s]
100%|██████████| 200/200 [00:21<00:00, 15.54it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:45:05,647 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:45:20,394 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:45:20,443 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.11.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.59it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.70it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.74it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.76it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.78it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.76it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.92it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.91it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.07it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.13it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.12it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.83it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.89it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.97it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.13it/s]
 40%|████      | 81/200 [00:10<00:13,  9.15it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.23it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.50it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.57it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.66it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.91it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.91it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.94it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.04it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.05it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.06it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.11it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.15it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.15it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.22it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.29it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.42it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.49it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.51it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.54it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.65it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.74it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.82it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.82it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.01it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.29it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.89it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 11.99it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.09it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.34it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.40it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.61it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.79it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.08it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.32it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.82it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.19it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.52it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.88it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.18it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.42it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:45:41,966 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:45:56,618 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:45:56,667 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.11.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.77it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.82it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.83it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.11it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.12it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.20it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.44it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.94it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.99it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.05it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.07it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.06it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.07it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.12it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.12it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.18it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.29it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.53it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.59it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.61it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.72it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.76it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.89it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.17it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.25it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.35it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.48it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.52it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.59it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.60it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.61it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.70it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.76it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.82it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.88it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.92it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.95it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.07it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.37it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.59it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.85it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.02it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.12it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.36it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.49it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.59it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.76it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.88it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.23it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.43it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.92it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.29it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.67it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.98it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.33it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.71it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:46:18,061 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:46:32,733 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:46:32,781 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.12.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.58it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.76it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.79it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.87it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.88it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.88it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.90it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.97it/s]
 20%|██        | 41/200 [00:05<00:19,  8.01it/s]
 21%|██        | 42/200 [00:05<00:19,  8.02it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.01it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.18it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.20it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.23it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.24it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.24it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.58it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.84it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.23it/s]
 41%|████      | 82/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.28it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.28it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.36it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.59it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.69it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.74it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.76it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.79it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.82it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.89it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:09,  9.88it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.94it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.98it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.97it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.12it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.23it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.33it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.39it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.40it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.49it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.55it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.59it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.55it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.70it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.77it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.81it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.83it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.87it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.88it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.90it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.95it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.30it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.53it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.79it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.98it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.12it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.21it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.36it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.45it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.56it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.70it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.90it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.10it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.30it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.64it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.13it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.44it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.80it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.11it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.45it/s]
100%|██████████| 200/200 [00:21<00:00, 15.78it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:46:54,178 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:47:08,968 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:47:09,016 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.12.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.97it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.79it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.86it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.98it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.17it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:24,  7.42it/s]
 11%|█         | 22/200 [00:03<00:23,  7.52it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.60it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.73it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.79it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.81it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.90it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.12it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.14it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.15it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.32it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.94it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:14,  9.00it/s]
 38%|███▊      | 75/200 [00:09<00:14,  8.93it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.97it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.92it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.97it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.06it/s]
 40%|████      | 80/200 [00:10<00:13,  9.07it/s]
 40%|████      | 81/200 [00:10<00:13,  9.05it/s]
 41%|████      | 82/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.19it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.17it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.20it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.52it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.53it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.65it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.00it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.04it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.05it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.14it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.24it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.29it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.39it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.45it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.50it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.54it/s]
 74%|███████▎  | 147/200 [00:17<00:05, 10.59it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.69it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.72it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.81it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.98it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.24it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.51it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.91it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.02it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.11it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.41it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.53it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.69it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.78it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.11it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.27it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.77it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.07it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.45it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.82it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.12it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.47it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:22:47:30,569 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:47:45,228 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:47:45,277 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.12.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.73it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.91it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.10it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.32it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.76it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.84it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.97it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.97it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.07it/s]
 40%|████      | 80/200 [00:10<00:13,  9.10it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.17it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.20it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.18it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:12<00:11,  9.41it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.69it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.73it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.89it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.07it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.09it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.10it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.10it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.09it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.10it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.22it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.28it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.37it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.53it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.55it/s]
 74%|███████▎  | 147/200 [00:17<00:05, 10.60it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.75it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.74it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.77it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.80it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.98it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.25it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.52it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.73it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.86it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 11.96it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.11it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.35it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.41it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.56it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.68it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.01it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.34it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.81it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.20it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.46it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.82it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.07it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:48:06,806 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:48:21,347 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:48:21,396 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.12.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:37,  5.35it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.20it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.22it/s]
 10%|█         | 20/200 [00:03<00:24,  7.36it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.91it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.04it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.20it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.72it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.96it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.13it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.14it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.18it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.59it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.91it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.04it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.08it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.08it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.10it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.10it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.22it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.25it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.51it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.53it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.75it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.78it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.82it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.87it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.86it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.21it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.70it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.99it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.10it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.36it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.57it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.76it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.03it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.34it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.64it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.01it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.36it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.68it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.04it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.36it/s]
100%|██████████| 200/200 [00:21<00:00, 15.71it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:22:48:42,886 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:48:57,630 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:48:57,679 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.12.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.92it/s]
  4%|▎         | 7/200 [00:01<00:31,  6.03it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.29it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.86it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.25it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.63it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.73it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.81it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.87it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.90it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.92it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.20it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.21it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.24it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.25it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.24it/s]
 30%|███       | 60/200 [00:08<00:17,  8.23it/s]
 30%|███       | 61/200 [00:08<00:16,  8.23it/s]
 31%|███       | 62/200 [00:08<00:16,  8.24it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.70it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.83it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.95it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.97it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.12it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.19it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.28it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.30it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:10<00:12,  9.30it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.54it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.79it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.82it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.93it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.04it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.05it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.04it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.08it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.18it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.24it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.29it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.48it/s]
 68%|██████▊   | 137/200 [00:15<00:05, 10.53it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.57it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.56it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.62it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.72it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.76it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.77it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.90it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.93it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.93it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.06it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.32it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.60it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.85it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.02it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.13it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.33it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.48it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.62it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.76it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.90it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.27it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.52it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.98it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.29it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.70it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.01it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.31it/s]
100%|█████████▉| 199/200 [00:20<00:00, 15.69it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:22:49:19,050 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:49:33,794 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:49:33,844 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.13.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.03it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.18it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.25it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.62it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.70it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.73it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.78it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.12it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  9.00it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.04it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.07it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.24it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.28it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.28it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.35it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.37it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.62it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.67it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.70it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.71it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.78it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.81it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.94it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.98it/s]
 56%|█████▌    | 111/200 [00:13<00:08, 10.00it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.04it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.10it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.10it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.08it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.17it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.26it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.33it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.47it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.51it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.54it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.57it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.63it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.72it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.78it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.90it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.94it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.06it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.41it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.69it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.91it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.07it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.17it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.35it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.50it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.65it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.98it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.21it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.43it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.95it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.30it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.69it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.97it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.31it/s]
100%|█████████▉| 199/200 [00:20<00:00, 15.67it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:22:49:55,231 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:50:10,001 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:50:10,050 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.13.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.74it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.79it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:21,  7.76it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s]
 20%|██        | 40/200 [00:05<00:20,  7.86it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.15it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.12it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.15it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.53it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.64it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.78it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.94it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.97it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.98it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.98it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.16it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.19it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.24it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.54it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.72it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.72it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.79it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.83it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.88it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.99it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.12it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.22it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.37it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.45it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.47it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.50it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.68it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.74it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.83it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.88it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.42it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.64it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.08it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.36it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.51it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.63it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.70it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.95it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.17it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.48it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.94it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.26it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.66it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.92it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.31it/s]
100%|██████████| 200/200 [00:21<00:00, 15.60it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:50:31,571 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:50:46,368 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:50:46,417 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.13.feed_forward.w1
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.58it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.76it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.84it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.72it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.79it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.83it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.16it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.33it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.88it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.93it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.96it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.99it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.04it/s]
 40%|████      | 80/200 [00:10<00:13,  9.08it/s]
 40%|████      | 81/200 [00:10<00:13,  9.10it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.19it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.24it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.48it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.62it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.83it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.13it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.22it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.48it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.53it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.60it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.69it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.74it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.82it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.98it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.27it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.75it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.87it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 11.99it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.11it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.41it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.48it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.61it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.77it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.10it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.33it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.81it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.20it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.48it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.85it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.10it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.47it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:22:51:07,924 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:51:22,565 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:51:22,615 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.13.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.10it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.85it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.98it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.06it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.16it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.61it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.76it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.79it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.80it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s]
 20%|██        | 40/200 [00:05<00:20,  7.92it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.06it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.88it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.95it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.06it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.05it/s]
 40%|████      | 81/200 [00:10<00:13,  9.11it/s]
 41%|████      | 82/200 [00:10<00:12,  9.13it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.19it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.18it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.22it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.61it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.86it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.87it/s]
 56%|█████▌    | 111/200 [00:13<00:09,  9.87it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.84it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.88it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.97it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.96it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.96it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.96it/s]
 60%|██████    | 121/200 [00:14<00:07,  9.97it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.09it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.17it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.24it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.42it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.46it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.50it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.55it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.75it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.74it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.87it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.06it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.33it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.55it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.92it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.14it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.38it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.69it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.86it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.18it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.43it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.83it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.19it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.50it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.85it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.11it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:51:44,137 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:51:59,031 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:51:59,080 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.13.feed_forward.w2
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.94it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.76it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.81it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.82it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.10it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.14it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.43it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.61it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.79it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:13,  9.14it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.31it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.33it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.63it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.65it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.76it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.90it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.08it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.12it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.10it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.06it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.09it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.16it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.26it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.30it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.44it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.51it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.56it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.58it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.64it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.69it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.75it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.80it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.87it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.93it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.09it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.34it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.61it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.83it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.01it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.13it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.33it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.47it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.61it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.74it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.84it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.16it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.40it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.89it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.28it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.60it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.97it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.28it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.57it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:52:20,494 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:52:35,274 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:52:35,323 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.14.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.76it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.84it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.52it/s]
 11%|█         | 22/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.63it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.70it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.77it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.77it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.82it/s]
 14%|█▍        | 28/200 [00:04<00:21,  7.82it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.86it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.88it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.88it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.93it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.97it/s]
 20%|██        | 40/200 [00:05<00:20,  7.99it/s]
 20%|██        | 41/200 [00:05<00:19,  7.97it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.10it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.14it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.19it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.22it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.23it/s]
 26%|██▌       | 52/200 [00:07<00:17,  8.22it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.22it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.25it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.24it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.24it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.04it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.07it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.07it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:10<00:12,  9.27it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.31it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.33it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.54it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.60it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.61it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.69it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.73it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.82it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.82it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.86it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.15it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.22it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.31it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.41it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.47it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.50it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.57it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.65it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.71it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.82it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.83it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.88it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.91it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.89it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.09it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.41it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.68it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.91it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.07it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.15it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.39it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.53it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.67it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.85it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 13.00it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.24it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.44it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 14.00it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.32it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.71it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.07it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.35it/s]
100%|█████████▉| 199/200 [00:20<00:00, 15.64it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:22:52:56,700 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:53:11,311 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:53:11,360 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.14.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.11it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.98it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.25it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.32it/s]
 10%|█         | 20/200 [00:03<00:24,  7.35it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.50it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.74it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.79it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.91it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.02it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.07it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:18,  8.10it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.16it/s]
 31%|███       | 62/200 [00:08<00:16,  8.14it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.29it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  8.97it/s]
 40%|████      | 80/200 [00:10<00:13,  9.03it/s]
 40%|████      | 81/200 [00:10<00:13,  9.06it/s]
 41%|████      | 82/200 [00:10<00:12,  9.13it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.11it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.18it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.20it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.24it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.83it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.02it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.99it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.06it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.21it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.26it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.30it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.37it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.44it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.46it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.51it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.56it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.72it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.82it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.99it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.26it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.91it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.01it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.14it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.41it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.71it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.79it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.13it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.29it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.74it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.07it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.46it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.76it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.07it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.39it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:53:32,898 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:53:47,508 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:53:47,557 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.14.feed_forward.w1
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.70it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.13it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.57it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.69it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.78it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:13,  9.12it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.12it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.16it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.17it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.22it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.60it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.95it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.05it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.20it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.25it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.40it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.49it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.64it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.73it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.80it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.17it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.40it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.64it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.09it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.64it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.71it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.95it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.25it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.61it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.04it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.31it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.66it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.95it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.30it/s]
100%|██████████| 200/200 [00:21<00:00, 15.60it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:54:09,069 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:54:23,731 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:54:23,781 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.14.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.86it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.97it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.04it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.07it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.97it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.96it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.06it/s]
 40%|████      | 80/200 [00:10<00:13,  9.09it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.47it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.76it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.04it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.05it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.05it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.04it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.12it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.22it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.25it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.32it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.54it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.64it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.73it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.75it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.79it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.83it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.89it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.92it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.46it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.70it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.88it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 12.01it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.04it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.20it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.32it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.45it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.55it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.77it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.00it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.29it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.61it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.99it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.31it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.63it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.04it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.38it/s]
100%|██████████| 200/200 [00:21<00:00, 15.63it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:22:54:45,254 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:54:59,978 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:55:00,027 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.14.feed_forward.w2
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.78it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.17it/s]
  9%|▉         | 18/200 [00:02<00:24,  7.28it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.63it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.73it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.79it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.80it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.14it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.16it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.23it/s]
 31%|███       | 62/200 [00:08<00:16,  8.26it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.96it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.05it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.06it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.09it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.12it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.12it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.21it/s]
 40%|████      | 81/200 [00:10<00:12,  9.23it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.18it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.19it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.64it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.68it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.69it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.73it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.72it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.92it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.98it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.98it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.04it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.09it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.07it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.15it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.32it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.49it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.57it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.60it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.62it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.64it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.73it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.81it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.84it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.82it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.84it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.90it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.21it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.75it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.93it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.08it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.17it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.38it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.66it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.78it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.05it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.33it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.66it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.03it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.34it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.76it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.14it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.45it/s]
100%|██████████| 200/200 [00:21<00:00, 15.68it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:55:21,430 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:55:36,352 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:55:36,402 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.15.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.79it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.82it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.20it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.42it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.56it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.81it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.78it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.31it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.31it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.40it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.62it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.98it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.01it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.08it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.07it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.04it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.12it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.20it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.27it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.48it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.55it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.59it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.70it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.73it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.78it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.90it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.90it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.26it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.56it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.80it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.99it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.09it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.17it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.31it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.40it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.57it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.73it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.86it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.08it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.29it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.66it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.10it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.47it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.81it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.17it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.52it/s]
100%|██████████| 200/200 [00:21<00:00, 15.78it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:22:55:57,823 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:56:12,460 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:56:12,509 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.15.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.05it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.09it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:17,  8.11it/s]
 31%|███       | 62/200 [00:08<00:16,  8.17it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.43it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.79it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.83it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.02it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.99it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.97it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.10it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.72it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.65it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.85it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.96it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.97it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.10it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.18it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.25it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.32it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.44it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.49it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.59it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.67it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.75it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.83it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.89it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.02it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.32it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.58it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.79it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.91it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.00it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.13it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.41it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.64it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.79it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.08it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.26it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.71it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.09it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.45it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.84it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.11it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.47it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:56:34,008 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:56:48,816 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:56:48,865 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.15.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.76it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.26it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.69it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.72it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.74it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.73it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.86it/s]
 20%|██        | 40/200 [00:05<00:20,  7.92it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.09it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.09it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.11it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.14it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.97it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.20it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.18it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.21it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.27it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.57it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.64it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.68it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.78it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.92it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.05it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.21it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.50it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.80it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.79it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.42it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.63it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.09it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.34it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.45it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.57it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.70it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.98it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.23it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.62it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.02it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.32it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.64it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.94it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.32it/s]
100%|██████████| 200/200 [00:21<00:00, 15.61it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:22:57:10,375 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:57:25,647 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:57:25,696 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.15.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.16it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.25it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.23it/s]
 10%|█         | 20/200 [00:03<00:24,  7.32it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.48it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.72it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.81it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.74it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.79it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.06it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:18,  8.10it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.10it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.29it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.43it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.70it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.98it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:13,  9.07it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.14it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.79it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.83it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.02it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.03it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.04it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.06it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.20it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.27it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.35it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.48it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.52it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.56it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.60it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.72it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.82it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.00it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.29it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.56it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.78it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.92it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.02it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.13it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.39it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.51it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.72it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.85it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.20it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.38it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.80it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.15it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.51it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.86it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.14it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.49it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:22:57:47,226 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:58:01,874 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:58:01,923 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.15.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.03it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.18it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.23it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.79it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.84it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.86it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.87it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.89it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.10it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.12it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.42it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.96it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.08it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.11it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.18it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.24it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.29it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.33it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.69it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.74it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.03it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.14it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.24it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.24it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.33it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.44it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.51it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.56it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.59it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.63it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.68it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.73it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.77it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.79it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.87it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.90it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.92it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.90it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.06it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.31it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.60it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.84it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.00it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.10it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.20it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.45it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.61it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.70it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.85it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.15it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.43it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.88it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.27it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.62it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.99it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.29it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.57it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:22:58:23,337 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:58:37,859 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:58:37,907 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.16.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.54it/s]
 11%|█         | 22/200 [00:03<00:23,  7.61it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.65it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.76it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.79it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.82it/s]
 14%|█▍        | 28/200 [00:04<00:21,  7.85it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.85it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.88it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.87it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.87it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.89it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.89it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.89it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.97it/s]
 20%|██        | 41/200 [00:05<00:19,  8.01it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.07it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.11it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.14it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.18it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.20it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.21it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.24it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.22it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.06it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.13it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.12it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.21it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.30it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.30it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.32it/s]
 44%|████▎     | 87/200 [00:10<00:12,  9.33it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.32it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.37it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.62it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.72it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.78it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.83it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.83it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.93it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.94it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08, 10.01it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.07it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.11it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.09it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.05it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.06it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.09it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.17it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.23it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.31it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 137/200 [00:15<00:05, 10.50it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.60it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.64it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.73it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.77it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.81it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.90it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.94it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.11it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.43it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.68it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.91it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.08it/s]
 86%|████████▌ | 171/200 [00:18<00:02, 12.19it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.39it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.52it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.61it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 13.00it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.32it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.45it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.98it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.31it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.68it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.05it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.30it/s]
100%|█████████▉| 199/200 [00:20<00:00, 15.69it/s]
100%|██████████| 200/200 [00:21<00:00,  9.51it/s]
2024-12-18:22:58:59,269 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:59:13,864 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:59:13,913 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.16.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.68it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.23it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.15it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.11it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.13it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.56it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.69it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.02it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.95it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:13,  9.14it/s]
 41%|████      | 82/200 [00:10<00:13,  9.05it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.11it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.15it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.18it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.20it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.18it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.24it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.24it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.37it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.50it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.63it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.66it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.69it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.87it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.00it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.04it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.05it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.13it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.25it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.27it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.39it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.46it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.49it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.56it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.62it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.75it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.81it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.87it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.03it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.29it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.51it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.90it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.03it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.14it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.40it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.51it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.66it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.77it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.09it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.28it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.76it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.10it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.46it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.79it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.11it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.45it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:22:59:35,454 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:22:59:50,075 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:22:59:50,124 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.16.feed_forward.w1
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.62it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.74it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.11it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:13,  9.14it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.25it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.20it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.53it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.51it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.63it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.83it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.12it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.16it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.23it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.24it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.29it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.42it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.48it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.59it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.65it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.69it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.75it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.81it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.89it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.16it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.42it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.69it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.86it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 12.00it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.05it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.20it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.31it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.41it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.50it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.67it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.93it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.18it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.58it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.94it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.27it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.64it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.01it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.31it/s]
100%|██████████| 200/200 [00:21<00:00, 15.61it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:00:11,618 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:00:26,374 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:00:26,423 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.16.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.85it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:24,  7.43it/s]
 11%|█         | 22/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.64it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.88it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.97it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.21it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.16it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.21it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.17it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.73it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.76it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.75it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.80it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.92it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.98it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.04it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.12it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.22it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.44it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.52it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.56it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.65it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.68it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.76it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.80it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.81it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.88it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.45it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.71it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.89it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 12.00it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.26it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.38it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.52it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.75it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.01it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.25it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.64it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.03it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.32it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.62it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.02it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.34it/s]
100%|██████████| 200/200 [00:21<00:00, 15.54it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:00:47,916 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:01:02,587 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:01:02,635 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.16.feed_forward.w2
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.62it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.87it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.07it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.21it/s]
 30%|███       | 61/200 [00:08<00:16,  8.24it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.82it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.59it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.76it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.79it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.81it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.85it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.90it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.10it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.12it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.12it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.10it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.15it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.23it/s]
 64%|██████▍   | 128/200 [00:15<00:06, 10.29it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.41it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.52it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.57it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.60it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.62it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.74it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.78it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.81it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.88it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.92it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.93it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.23it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.49it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.73it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.94it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.07it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.13it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.40it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.53it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.71it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.84it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.11it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.33it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.65it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.04it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.36it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.78it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.13it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.46it/s]
100%|██████████| 200/200 [00:21<00:00, 15.72it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:23:01:24,054 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:01:38,766 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:01:38,815 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.17.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.29it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.45it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.64it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.74it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.79it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.79it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.89it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  8.02it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.18it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.19it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.21it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.23it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.25it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.23it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.24it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.44it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.72it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.83it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.97it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.08it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.13it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.29it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.31it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.16it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.38it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.61it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.65it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.78it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.80it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.94it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.98it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.98it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.03it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.07it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.05it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.04it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.04it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.13it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.20it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.25it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.39it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.49it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.53it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.58it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.62it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.70it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.77it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.82it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.83it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.88it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.91it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.89it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.92it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.28it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.53it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.79it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.99it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.12it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.20it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.34it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.44it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.55it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.73it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.90it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.09it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.32it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.68it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.16it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.44it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.85it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.23it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00, 15.75it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:02:00,182 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:02:14,932 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:02:14,981 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.17.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.18it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.22it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.12it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.23it/s]
 30%|███       | 60/200 [00:08<00:17,  8.21it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.31it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.71it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.96it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.25it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.29it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.30it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.27it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.57it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.60it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.66it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.89it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.04it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.07it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.09it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.08it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.06it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.09it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.10it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.22it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.37it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.45it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.69it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.73it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.86it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.89it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.43it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.63it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.36it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.48it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.59it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.65it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.91it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.19it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.51it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.92it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.22it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.51it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.88it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.25it/s]
100%|██████████| 200/200 [00:21<00:00, 15.56it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:02:36,472 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:02:51,055 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:02:51,105 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.17.feed_forward.w1
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.29it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.24it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.69it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.96it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.08it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.12it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.16it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.10it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.43it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.76it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.02it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.06it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.19it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.50it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.69it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.03it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.00it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.21it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.27it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.49it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.55it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.61it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.75it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.80it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.17it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.42it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.65it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.85it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.08it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.61it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.68it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.96it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.24it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.57it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.00it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.34it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.69it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.96it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.27it/s]
100%|██████████| 200/200 [00:21<00:00, 15.61it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:03:12,620 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:03:27,923 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:03:27,972 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.17.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.22it/s]
 30%|███       | 60/200 [00:08<00:17,  8.22it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.99it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.97it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.05it/s]
 40%|████      | 80/200 [00:10<00:13,  9.10it/s]
 40%|████      | 81/200 [00:10<00:13,  9.13it/s]
 41%|████      | 82/200 [00:10<00:12,  9.12it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.17it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.27it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.48it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.62it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.87it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.89it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.92it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.06it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.08it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.13it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.11it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.11it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.22it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.29it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.43it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.45it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.53it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.62it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.65it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.69it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.83it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.04it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.35it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.60it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.80it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.90it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.02it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.14it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.45it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.66it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.83it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.14it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.30it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.76it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.15it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.49it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.87it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.16it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.50it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:03:49,444 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:04:04,208 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:04:04,257 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.17.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.69it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.84it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.11it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.95it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.98it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.04it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.58it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.61it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.90it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.90it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.04it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.09it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.09it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.10it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.10it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.14it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.19it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.25it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.41it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.48it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.52it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.59it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.59it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.64it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.73it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.74it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.80it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.89it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.89it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.91it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.23it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.48it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.92it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.01it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.12it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.36it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.45it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.55it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.75it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.02it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.33it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.67it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.09it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.40it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.81it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.10it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.50it/s]
100%|██████████| 200/200 [00:21<00:00, 15.88it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:23:04:25,681 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:04:40,488 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:04:40,537 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.18.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.77it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.81it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.79it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.83it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.88it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.87it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.90it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.90it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.90it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.87it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.91it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.96it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.21it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.22it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.21it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.22it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.21it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.21it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.23it/s]
 31%|███       | 62/200 [00:08<00:16,  8.26it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.45it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.57it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.75it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.86it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.99it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.99it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.07it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.09it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.13it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.15it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.12it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.17it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.28it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.29it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:10<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.38it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.52it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.70it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.75it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.78it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.72it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.88it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.13it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.22it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.29it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.45it/s]
 68%|██████▊   | 137/200 [00:15<00:05, 10.50it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.54it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.60it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.67it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.74it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.78it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.88it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.90it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.89it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.06it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.39it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.68it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.91it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.16it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.36it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.54it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.69it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.87it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 13.00it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.23it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.43it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.99it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.39it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.74it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.04it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.34it/s]
100%|█████████▉| 199/200 [00:20<00:00, 15.67it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:05:01,920 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:05:16,464 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:05:16,513 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.18.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.48it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.79it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.61it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.70it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.68it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.90it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.14it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.94it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.99it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.95it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:13,  9.08it/s]
 41%|████      | 82/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.53it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.58it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.76it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.85it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.00it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.05it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.20it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.27it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.39it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.46it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.50it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.55it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.74it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.82it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.00it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.27it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.91it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.01it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.42it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.70it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.77it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.09it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.27it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.76it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.11it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.49it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.80it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.10it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:05:38,040 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:05:52,755 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:05:52,805 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.18.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.87it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.96it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.12it/s]
 30%|███       | 61/200 [00:08<00:17,  8.16it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.40it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.73it/s]
 34%|███▍      | 68/200 [00:08<00:15,  8.79it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.83it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.87it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.91it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.99it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.17it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.25it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.49it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.62it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.61it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.04it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.07it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.07it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.20it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.26it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.29it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.40it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.55it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.59it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.62it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.78it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.76it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.03it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.31it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.55it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.90it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.01it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.15it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.30it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.44it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.55it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.62it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.71it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.11it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.37it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.84it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.23it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.52it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.83it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.07it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.43it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:06:14,322 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:06:28,987 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:06:29,037 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.18.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.62it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.81it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.05it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.20it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.21it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.99it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.28it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.24it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.64it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.94it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.02it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.03it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.22it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.28it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.40it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.48it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.52it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.60it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.77it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.80it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.87it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.44it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.69it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.87it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.95it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.07it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.31it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.46it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.56it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.77it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.03it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.32it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.59it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.02it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.33it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.66it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.03it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.33it/s]
100%|██████████| 200/200 [00:21<00:00, 15.56it/s]
100%|██████████| 200/200 [00:21<00:00,  9.46it/s]
2024-12-18:23:06:50,522 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:07:05,223 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:07:05,271 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.18.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.92it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.03it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.29it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.86it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.16it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.31it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.61it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.96it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.96it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.02it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.08it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.09it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.11it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.22it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.29it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.44it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.54it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.58it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.58it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.64it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.68it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.77it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.77it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.80it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.87it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.90it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.03it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.34it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.60it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.81it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.99it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.08it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.39it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.48it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.71it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.86it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.19it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.42it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.91it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.21it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.64it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.01it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.28it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.63it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:23:07:26,694 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:07:41,375 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:07:41,423 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.19.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.17it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.28it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.35it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.48it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.74it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.73it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.86it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.97it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.97it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.18it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.22it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.22it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.11it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.23it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.24it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.23it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.73it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.83it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.97it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.09it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.12it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.29it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.30it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.37it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.37it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.63it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.70it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.79it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.96it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.03it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.07it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.05it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.14it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.20it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.27it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.30it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.39it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.42it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.49it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.51it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.57it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.70it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.75it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.77it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.83it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.89it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.92it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.93it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.23it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.54it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.80it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 12.00it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.12it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.19it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.44it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.59it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.74it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.96it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.10it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.38it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.73it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.15it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.52it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.86it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.19it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00, 15.82it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:08:02,823 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:08:19,572 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:08:19,620 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.19.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.76it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.84it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:24,  7.44it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.76it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.71it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.73it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.97it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.05it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.20it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.11it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.23it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.31it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.90it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.02it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.02it/s]
 40%|████      | 80/200 [00:10<00:13,  9.11it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.28it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.27it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.46it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.54it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.59it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.95it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.07it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.09it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.09it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.11it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.17it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.29it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.43it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.50it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.55it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.64it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.71it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.76it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.79it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.90it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.43it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.70it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.86it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.96it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.04it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.20it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.32it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.42it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.49it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.65it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.88it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.15it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.54it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.96it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.29it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.65it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.95it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.26it/s]
100%|██████████| 200/200 [00:21<00:00, 15.65it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:08:41,109 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:08:55,897 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:08:55,945 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.19.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.20it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.43it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.83it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s]
 20%|██        | 40/200 [00:05<00:20,  7.90it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.12it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.33it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.84it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.84it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.96it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.00it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.07it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.16it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.21it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.23it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.37it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.42it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.55it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.63it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.76it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.81it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.79it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.02it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.04it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.05it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.20it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.26it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.22it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.39it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.45it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.49it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.54it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.63it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.71it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.71it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.80it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.98it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.26it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.51it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.72it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.85it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 11.96it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.11it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.38it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.58it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.71it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.04it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.27it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.79it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.16it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.45it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.81it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.05it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.41it/s]
100%|██████████| 200/200 [00:21<00:00,  9.42it/s]
2024-12-18:23:09:17,492 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:09:32,118 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:09:32,167 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.19.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.17it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.27it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.62it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.70it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.79it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.81it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.97it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.13it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.59it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.55it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.72it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.78it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.83it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.99it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.11it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.17it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.51it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.54it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.64it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.71it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.79it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.83it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.87it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.20it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.72it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.87it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.95it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.05it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.62it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.01it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.31it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.69it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.12it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.42it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.69it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.04it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.38it/s]
100%|██████████| 200/200 [00:21<00:00, 15.69it/s]
100%|██████████| 200/200 [00:21<00:00,  9.46it/s]
2024-12-18:23:09:53,629 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:10:08,927 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:10:08,976 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.19.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.25it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.80it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.88it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.94it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.19it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.25it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.69it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.82it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.14it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.21it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.18it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.63it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.66it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.71it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.74it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.88it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.08it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.05it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.14it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.24it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.28it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.45it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.52it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.59it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.58it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.64it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.73it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.76it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.82it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.81it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.93it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.23it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.49it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.75it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.94it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.07it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.16it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.31it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.46it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.67it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.01it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.33it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.66it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.11it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.43it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.84it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.20it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00, 15.79it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:10:30,382 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:10:45,079 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:10:45,128 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.20.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.35it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.73it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.81it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.79it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.84it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.87it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.87it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.90it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.91it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.13it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.16it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.71it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.21it/s]
 41%|████      | 82/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.28it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.58it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.71it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.88it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.02it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.02it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.09it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.18it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.25it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.35it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.46it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.52it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.57it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.68it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.74it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.76it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.78it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.83it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.87it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.87it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.91it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.27it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.55it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.81it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.98it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.10it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.17it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.32it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.46it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.68it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.86it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.09it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.35it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.62it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.11it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.46it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.84it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.23it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.46it/s]
100%|██████████| 200/200 [00:21<00:00, 15.78it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:23:11:06,550 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:11:21,152 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:11:21,200 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.20.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.44it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:21,  7.76it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.83it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.97it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.09it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:17,  8.15it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.43it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.85it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.98it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.31it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.32it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.62it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.75it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.86it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.93it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.21it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.23it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.31it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.64it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.71it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.76it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.78it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.85it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.88it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.88it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.20it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.42it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.63it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.99it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.10it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.40it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.59it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.75it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.99it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.25it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.60it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.96it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.25it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.61it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.02it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.29it/s]
100%|██████████| 200/200 [00:21<00:00, 15.70it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:11:42,693 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:11:57,262 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:11:57,311 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.20.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.10it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:17,  8.14it/s]
 31%|███       | 62/200 [00:08<00:16,  8.13it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.67it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.89it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.87it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.97it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.97it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.97it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.06it/s]
 40%|████      | 80/200 [00:10<00:13,  9.10it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.25it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.48it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.71it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.81it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.19it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.23it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.50it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.55it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.64it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.71it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.81it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.86it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.20it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.44it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.65it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.82it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.08it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.46it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.59it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.70it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.95it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.19it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.56it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.00it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.30it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.67it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.96it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.32it/s]
100%|██████████| 200/200 [00:21<00:00, 15.62it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:12:18,827 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:12:33,474 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:12:33,522 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.20.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.04it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.15it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.31it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.40it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.57it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.71it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.77it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.86it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.02it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.99it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.06it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:13,  9.14it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.20it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.59it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.62it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.79it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.84it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.96it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.06it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.18it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.36it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.43it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.46it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.50it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.61it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.66it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.75it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.81it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.87it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.20it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.46it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.85it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.07it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.30it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.46it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.62it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.69it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.98it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.30it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.63it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.03it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.36it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.70it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.97it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.27it/s]
100%|██████████| 200/200 [00:21<00:00, 15.68it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:12:55,025 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:13:09,502 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:13:09,551 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.20.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.76it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.84it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.62it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.75it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.79it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.89it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.21it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.21it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.71it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.81it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.07it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.09it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.31it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.31it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.31it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.39it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.39it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.53it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.55it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.74it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.79it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.80it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.81it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.83it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.88it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.88it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.98it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.09it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.10it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.11it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.09it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.11it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.17it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.23it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.32it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.45it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.59it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.61it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.65it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.73it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.77it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.82it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.84it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.89it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.91it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.92it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.22it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.93it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.11it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.66it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.01it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.26it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.66it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.08it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.40it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.84it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.13it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00, 15.76it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:13:30,954 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:13:45,611 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:13:45,660 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.21.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.18it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.44it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.87it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.86it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.97it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.11it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.23it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.22it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.94it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.99it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.04it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.09it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.13it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.11it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.31it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.63it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.67it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.71it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.76it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.78it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.80it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.83it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.94it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.95it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.96it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.99it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.04it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.10it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.11it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.09it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.17it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.26it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.32it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.42it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.49it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.56it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.62it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.70it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.77it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.81it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.86it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.90it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.09it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.41it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.69it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.90it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.04it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.14it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.36it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.50it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.62it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.78it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.98it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.29it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.41it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.97it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.35it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.66it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.99it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.35it/s]
100%|█████████▉| 199/200 [00:20<00:00, 15.75it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:14:07,046 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:14:21,741 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:14:21,790 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.21.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.22it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.36it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.86it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.12it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.99it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.98it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.94it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.04it/s]
 40%|████      | 80/200 [00:10<00:13,  9.06it/s]
 40%|████      | 81/200 [00:10<00:13,  9.14it/s]
 41%|████      | 82/200 [00:10<00:12,  9.12it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.21it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.16it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.23it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.24it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.49it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.53it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.06it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.08it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.12it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.12it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.13it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.30it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.39it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.49it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.52it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.58it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.73it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.81it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.00it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.26it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.54it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.77it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.92it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.03it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.15it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.40it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.52it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.68it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.73it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.11it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.26it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.72it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.05it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.41it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.78it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.06it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.38it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:14:43,315 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:14:57,928 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:14:57,976 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.21.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.92it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.03it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.44it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.60it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.22it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.73it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.87it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.96it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.12it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.97it/s]
 37%|███▋      | 74/200 [00:09<00:14,  9.00it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.26it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.59it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.50it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.63it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.69it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.00it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.06it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.05it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.04it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.04it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.09it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.14it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.24it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.25it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.29it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.41it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.46it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.50it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.61it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.65it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.68it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.81it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.02it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.31it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.73it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.91it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.02it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.39it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.51it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.66it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.80it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.10it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.39it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.80it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.15it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.51it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.86it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.08it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.46it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:15:19,488 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:15:34,343 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:15:34,392 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.21.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.97it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.11it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.63it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.76it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:18,  8.11it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.70it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.90it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.97it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.06it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:12<00:11,  9.44it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.61it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.89it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.92it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.04it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.06it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.08it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.11it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.10it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.11it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.22it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.28it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.39it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.45it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.49it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.57it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.64it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.72it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.82it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.85it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.01it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.29it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.57it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.78it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.93it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.15it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.39it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.76it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.89it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.18it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.40it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.85it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.21it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.54it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.88it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.11it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.49it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:15:55,874 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:16:10,598 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:16:10,647 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.21.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.77it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:24,  7.44it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.69it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.87it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.90it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.97it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.93it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.93it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.97it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.09it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.09it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.20it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.33it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.35it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.36it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.38it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.54it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.60it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.65it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.66it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.73it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.79it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.90it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.90it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.85it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.93it/s]
 58%|█████▊    | 116/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.98it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.04it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.07it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.20it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.40it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.46it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.52it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.61it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.61it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.64it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.76it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.81it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.84it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.89it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.92it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.93it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.22it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.48it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.75it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.92it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.04it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.08it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.35it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.44it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.61it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.79it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.03it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.30it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.71it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.13it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.41it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.83it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.11it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.40it/s]
100%|██████████| 200/200 [00:21<00:00, 15.78it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:23:16:32,076 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:16:46,645 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:16:46,694 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.22.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.84it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.63it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.70it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.75it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.77it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.82it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.81it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.87it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.87it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.87it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.87it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.91it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.03it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.07it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.11it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.19it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.21it/s]
 26%|██▌       | 52/200 [00:07<00:17,  8.22it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.22it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.15it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.53it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.81it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.94it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.13it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.12it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:13,  9.08it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.14it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.61it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.63it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.80it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.84it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.85it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.93it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.93it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.10it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.13it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.05it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.11it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.21it/s]
 64%|██████▍   | 128/200 [00:15<00:06, 10.29it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.35it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.49it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.54it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.55it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.58it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.71it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.75it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.79it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.92it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.93it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.25it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.53it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.80it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.99it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.12it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.18it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.31it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.43it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.61it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.74it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.96it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.13it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.36it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.74it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.19it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.49it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.81it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.23it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00, 15.81it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:17:08,078 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:17:22,801 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:17:22,850 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.22.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.13it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.11it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:17,  8.13it/s]
 31%|███       | 62/200 [00:08<00:16,  8.16it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.32it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.40it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.99it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.97it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.07it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.54it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.65it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.83it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.04it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.07it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.19it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.26it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.38it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.49it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.52it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.57it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.60it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.71it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.74it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.81it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.87it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.01it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.32it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.52it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.75it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.88it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.00it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.13it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.41it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.53it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.67it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.75it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.08it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.29it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.74it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.07it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.48it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.79it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.10it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:17:44,355 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:17:59,004 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:17:59,053 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.22.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.36it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.61it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.90it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.11it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.24it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.86it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.97it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.99it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.95it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.18it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.21it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.26it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.50it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.57it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.64it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.79it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.03it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.13it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.20it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.25it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.32it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.52it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.74it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.82it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.84it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.16it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.40it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.64it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.21it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.32it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.62it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.67it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.95it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.26it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.65it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.06it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.37it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.72it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.93it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.25it/s]
100%|██████████| 200/200 [00:21<00:00, 15.56it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:18:20,569 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:18:35,339 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:18:35,387 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.22.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.03it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.44it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.15it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.72it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.86it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.05it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.22it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.20it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.28it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.45it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.68it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.89it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.90it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.98it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.09it/s]
 40%|████      | 80/200 [00:10<00:13,  9.13it/s]
 40%|████      | 81/200 [00:10<00:13,  9.10it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.37it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.59it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.72it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.76it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.82it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.79it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.82it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.94it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.98it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.98it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.19it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.37it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.46it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.70it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.74it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.84it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.87it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.21it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.69it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.86it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 12.00it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.09it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.32it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.48it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.63it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.83it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.05it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.30it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.61it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.05it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.37it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.67it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.05it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.37it/s]
100%|██████████| 200/200 [00:21<00:00, 15.61it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:18:56,886 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:19:11,573 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:19:11,622 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.22.feed_forward.w2
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.25it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.14it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.20it/s]
  9%|▉         | 18/200 [00:02<00:24,  7.28it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.62it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.71it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.77it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.12it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.20it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.20it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.13it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.23it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.96it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.99it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.11it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.21it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.19it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.27it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.63it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.66it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.69it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.93it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.97it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.96it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.02it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.08it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.09it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.09it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.19it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.26it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.45it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.55it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.60it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.60it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.64it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.69it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.76it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.81it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.80it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.87it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.90it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.89it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.93it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.10it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.33it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.62it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.84it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.00it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.12it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.47it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.58it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.73it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.90it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.24it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.44it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.90it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.31it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.63it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.97it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.33it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.71it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:19:33,009 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:19:47,608 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:19:47,656 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.23.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.77it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.15it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.24it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.81it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.87it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.02it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.21it/s]
 41%|████      | 82/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.30it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.17it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.19it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.50it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.59it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.78it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.79it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.79it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.93it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.97it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.98it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.03it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.08it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.05it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.10it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.19it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.27it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.48it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.54it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.59it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.70it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.74it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.79it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.91it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.92it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.26it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.54it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.80it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.99it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.13it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.20it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.33it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.45it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.61it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.74it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.90it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.13it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.33it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.67it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.11it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.49it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.78it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.21it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.55it/s]
100%|██████████| 200/200 [00:21<00:00, 15.84it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:20:09,062 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:20:23,716 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:20:23,765 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.23.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.08it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.16it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.79it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.14it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.13it/s]
 30%|███       | 60/200 [00:08<00:17,  8.16it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.56it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.71it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.78it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.98it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  8.95it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.96it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.06it/s]
 40%|████      | 80/200 [00:10<00:13,  9.13it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:13,  9.07it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.11it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.19it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.63it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.55it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.04it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.07it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.09it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.12it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.11it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.11it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.20it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.28it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.38it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.46it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.52it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.60it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.64it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.83it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.88it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.04it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.31it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.54it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.92it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.15it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.44it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.69it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.79it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.15it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.36it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.80it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.17it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.53it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.88it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.13it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:20:45,263 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:20:59,836 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:20:59,885 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.23.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.16it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.26it/s]
 10%|▉         | 19/200 [00:02<00:25,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.36it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.63it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.68it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.72it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.76it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.79it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.89it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.90it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.10it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.09it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.10it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.57it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.70it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.93it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.10it/s]
 40%|████      | 81/200 [00:10<00:12,  9.15it/s]
 41%|████      | 82/200 [00:10<00:12,  9.13it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.20it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.19it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.23it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.35it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.53it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.61it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.77it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.83it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.81it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.85it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.94it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.98it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.97it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:08,  9.99it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.05it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.16it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:16<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.48it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.66it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.72it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.77it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.14it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.38it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.64it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.12it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.25it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.37it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.48it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.69it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.93it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.20it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.53it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.88it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.22it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.64it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.01it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.26it/s]
100%|██████████| 200/200 [00:21<00:00, 15.62it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:23:21:21,410 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:21:36,257 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:21:36,307 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.23.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.60it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.13it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.16it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.72it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.99it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.99it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  8.97it/s]
 40%|████      | 80/200 [00:10<00:13,  9.05it/s]
 40%|████      | 81/200 [00:10<00:13,  9.11it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.37it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.62it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.83it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.81it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.81it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.86it/s]
 56%|█████▌    | 111/200 [00:13<00:09,  9.88it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.95it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.00it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.98it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.04it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.14it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.23it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.38it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.46it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.52it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.56it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.77it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.05it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.35it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.58it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.77it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.93it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.40it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.74it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.89it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.19it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.43it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.85it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.22it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.54it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.88it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.21it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.53it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:21:57,811 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:22:12,435 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:22:12,484 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.23.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.11it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.19it/s]
  9%|▉         | 18/200 [00:02<00:24,  7.29it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.53it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.61it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.70it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.79it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.87it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.20it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.21it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.09it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.11it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.25it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.65it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.70it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.76it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.90it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.95it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.10it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.09it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.08it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.12it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.22it/s]
 64%|██████▍   | 128/200 [00:15<00:06, 10.29it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.50it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.56it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.56it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.61it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.62it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.80it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.83it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.82it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.87it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.89it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.22it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.48it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.75it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.94it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.08it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.16it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.39it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.55it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.71it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.06it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.33it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.63it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.04it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.42it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.78it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.17it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.47it/s]
100%|██████████| 200/200 [00:21<00:00, 15.87it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:22:33,881 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:22:48,605 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:22:48,654 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.24.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.08it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.17it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:24,  7.44it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.86it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.87it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.88it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.88it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.78it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.97it/s]
 20%|██        | 41/200 [00:05<00:19,  8.00it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.14it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.21it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.23it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.23it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.23it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.15it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.74it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.02it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.09it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.30it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.33it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.29it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.41it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.40it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.57it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.74it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.79it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.79it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.83it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.88it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.89it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.92it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.90it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.92it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.98it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 120/200 [00:14<00:08,  9.99it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.11it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.20it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.27it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.35it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.49it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.55it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.58it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.70it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.75it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.80it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.88it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.92it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.25it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.54it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.80it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.98it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.12it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.21it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.34it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.45it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.59it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.74it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.91it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.12it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.34it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.71it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.17it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.53it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.87it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.18it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00, 15.78it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:23:10,054 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:23:24,727 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:23:24,777 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.24.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.86it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.15it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.24it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.77it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.75it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.14it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:17,  8.16it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.44it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.23it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.24it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.41it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.82it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.89it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.05it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.12it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.22it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.26it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.27it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.38it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.49it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.53it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.56it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.79it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.83it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.79it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.87it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.05it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.33it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.55it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.89it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.03it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.17it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.45it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.55it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.66it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.80it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.08it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.31it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.81it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.12it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.48it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.85it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.05it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.42it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:23:46,283 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:24:00,876 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:24:00,925 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.24.feed_forward.w1
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.44it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.24it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.61it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.81it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.10it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.12it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.12it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.86it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.02it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.09it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.27it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.51it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.61it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.68it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.83it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.99it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.01it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.03it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.03it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.07it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.18it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.26it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.24it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.38it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.55it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.56it/s]
 74%|███████▎  | 147/200 [00:17<00:05, 10.59it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.73it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.75it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.77it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.79it/s]
 80%|████████  | 161/200 [00:18<00:03, 10.99it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.27it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.73it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.86it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 11.93it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.10it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.37it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.43it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.53it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.67it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.03it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.32it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.80it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.17it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.47it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.79it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.05it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.47it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:24:22,450 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:24:37,619 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:24:37,668 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.24.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.09it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.72it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.77it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.89it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.13it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:17,  8.12it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.79it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.07it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.09it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.14it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.17it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.24it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.55it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.63it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.82it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.89it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.97it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.05it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.08it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.14it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.15it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.14it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.30it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.40it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.40it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.54it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.58it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.61it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.79it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.85it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.00it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.31it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.77it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.92it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.40it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.55it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.73it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.87it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.15it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.41it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.83it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.20it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.54it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.90it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.12it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.46it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:24:59,153 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:25:13,892 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:25:13,941 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.24.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.76it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.77it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.72it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.14it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.81it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.94it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.91it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.06it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.28it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.61it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.63it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.88it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.93it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.07it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.10it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.12it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.11it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.12it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.20it/s]
 64%|██████▍   | 128/200 [00:15<00:06, 10.30it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.30it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.35it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.40it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.50it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.56it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.59it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.62it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.65it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.80it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.84it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.82it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.85it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.89it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.21it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.48it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.92it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.05it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.15it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.39it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.55it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.68it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.03it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.30it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.63it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.08it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.35it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.74it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.12it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.41it/s]
100%|██████████| 200/200 [00:21<00:00, 15.74it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:25:35,358 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:25:50,151 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:25:50,200 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.25.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.78it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.07it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.16it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.74it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.80it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.87it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.29it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.28it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.32it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.37it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.61it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.73it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.78it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.83it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.89it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:09,  9.87it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.92it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 116/200 [00:13<00:08,  9.98it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.98it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.13it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.19it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.40it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.47it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.54it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.60it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.73it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.77it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.80it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.92it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.95it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.24it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.54it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.81it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 12.00it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.12it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.20it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.44it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.64it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.77it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.97it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.15it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.32it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.72it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.18it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.49it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.86it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.23it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.52it/s]
100%|██████████| 200/200 [00:21<00:00, 15.78it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:26:11,594 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:26:26,277 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:26:26,326 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.25.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.35it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.85it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.76it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.69it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.74it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.73it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.05it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.14it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:18,  8.11it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.16it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.30it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.43it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.72it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.07it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.13it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.19it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.14it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.21it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.25it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.57it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.50it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.76it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.83it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.82it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.98it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.00it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.08it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.11it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.17it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.24it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.44it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.48it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.49it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.59it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.66it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.69it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.84it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.85it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.01it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.32it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.57it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.79it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.89it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.01it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.15it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.43it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.62it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.75it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.00it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.30it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.77it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.12it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.47it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.84it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.10it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.40it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:26:47,846 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:27:02,604 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:27:02,653 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.25.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.97it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.77it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:24,  7.44it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.77it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.84it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.87it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.96it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.16it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.11it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.75it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.06it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.16it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.22it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.38it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.51it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.46it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.53it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.62it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.68it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.72it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.82it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08, 10.00it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.05it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.06it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.10it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.20it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.23it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.32it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.48it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.50it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.67it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.72it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.77it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.81it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.15it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.36it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.64it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.03it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.13it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.24it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.36it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.47it/s]
 91%|█████████ | 182/200 [00:20<00:01, 12.67it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.94it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.20it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.52it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.93it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.26it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.61it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.00it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.26it/s]
100%|██████████| 200/200 [00:21<00:00, 15.56it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:23:27:24,190 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:27:38,883 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:27:38,932 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.25.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.73it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.92it/s]
  4%|▎         | 7/200 [00:01<00:31,  6.03it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.18it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.44it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.61it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.03it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.21it/s]
 30%|███       | 61/200 [00:08<00:16,  8.21it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.29it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.43it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.62it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.71it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.99it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.19it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.28it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.23it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.28it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.63it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.61it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.64it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.88it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.92it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.05it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.08it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.08it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.16it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.13it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.20it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.32it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.40it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.49it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.68it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.76it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.74it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.84it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.82it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.89it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.23it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.86it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 12.00it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.10it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.65it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.08it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.32it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.67it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.00it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.34it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.67it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.04it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.38it/s]
100%|██████████| 200/200 [00:21<00:00, 15.61it/s]
100%|██████████| 200/200 [00:21<00:00,  9.46it/s]
2024-12-18:23:28:00,398 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:28:15,127 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:28:15,176 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.25.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.63it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.71it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.76it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.77it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.83it/s]
 14%|█▍        | 28/200 [00:04<00:21,  7.84it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.86it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.86it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.89it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.18it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.70it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.82it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.95it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.98it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.14it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.06it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.19it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.28it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.28it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.30it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.28it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 88/200 [00:11<00:11,  9.34it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.62it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.72it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.90it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.96it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.06it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.07it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.05it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.06it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.10it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.17it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.25it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.36it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.52it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.54it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.57it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.60it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.61it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.74it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.80it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.83it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.82it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.87it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.91it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.95it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.21it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.48it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.75it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.95it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.08it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.16it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.41it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.57it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.71it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.83it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.07it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.32it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.66it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.08it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.45it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.80it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.16it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.56it/s]
100%|██████████| 200/200 [00:21<00:00, 15.88it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:28:36,566 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:28:51,360 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:28:51,408 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.26.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.76it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.24it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.79it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.08it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.64it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.72it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.77it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.81it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.82it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.86it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.87it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.91it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.95it/s]
 20%|██        | 40/200 [00:05<00:20,  7.98it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.10it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.22it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.23it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.21it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.21it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.42it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.56it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.70it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.81it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.95it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.13it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.21it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.90it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.99it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.03it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.08it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.11it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.10it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.11it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.23it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.29it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.42it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.51it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.51it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.56it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.60it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.72it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.80it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.87it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.91it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.11it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.44it/s]
 82%|████████▎ | 165/200 [00:18<00:02, 11.70it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.91it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.05it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.16it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.39it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.52it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.66it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.83it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.98it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.28it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.51it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.97it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.31it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.68it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.97it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.30it/s]
100%|█████████▉| 199/200 [00:20<00:00, 15.66it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:29:12,798 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:29:27,465 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:29:27,513 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.26.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.73it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.43it/s]
 11%|█         | 22/200 [00:03<00:23,  7.52it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.90it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.96it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.03it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.07it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.12it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.16it/s]
 30%|███       | 60/200 [00:08<00:17,  8.10it/s]
 30%|███       | 61/200 [00:08<00:17,  8.16it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.87it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.02it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.02it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.12it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.18it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.20it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.53it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.52it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.62it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.67it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.01it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.08it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.15it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.23it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.23it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.26it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.41it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.48it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.49it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.55it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.64it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.81it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.87it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.04it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.30it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.77it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.93it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.19it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.31it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.42it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.68it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.81it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.06it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.30it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.76it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.13it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.45it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.79it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.09it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.42it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:29:49,025 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:30:03,787 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:30:03,836 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.26.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.86it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.67it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.70it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.70it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.92it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.11it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.12it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.48it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.84it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.97it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:13,  9.12it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.10it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.16it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.11it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.17it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.22it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.29it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.49it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.55it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.64it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.63it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.05it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.07it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.19it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.50it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.54it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.79it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.81it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.83it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.84it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.43it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.63it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.08it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.59it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.65it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.93it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.25it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.61it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.03it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.32it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.70it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.01it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.31it/s]
100%|██████████| 200/200 [00:21<00:00, 15.62it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:30:25,349 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:30:40,056 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:30:40,105 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.26.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.47it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:24,  7.45it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.61it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.76it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.83it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.81it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.92it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.00it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.06it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.09it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.13it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.33it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.85it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.86it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.88it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.94it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.00it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.06it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.14it/s]
 40%|████      | 81/200 [00:10<00:13,  9.13it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.29it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.28it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.15it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.16it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.23it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.71it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.76it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.72it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.73it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.79it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.81it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.97it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.99it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.05it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.19it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.37it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.46it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.52it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.72it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.82it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.82it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.20it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.46it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.65it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.21it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.31it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.45it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.61it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.72it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.99it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.22it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.52it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.97it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.33it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.65it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.95it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.27it/s]
100%|██████████| 200/200 [00:21<00:00, 15.57it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:31:01,620 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:31:16,523 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:31:16,571 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.26.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.11it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.85it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.61it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.74it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.79it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.81it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.87it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.86it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.90it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.98it/s]
 21%|██        | 42/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.02it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.23it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:17,  8.17it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.70it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.77it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.87it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.97it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.06it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.24it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.33it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.62it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.62it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.78it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.88it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.88it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.10it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.11it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.10it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.11it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.16it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.25it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.42it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.50it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.60it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.61it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.62it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.73it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.79it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.84it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.87it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.91it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.23it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.49it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.75it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.94it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.08it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.13it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.39it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.57it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.73it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.03it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.35it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.67it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.07it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.38it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.83it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.18it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00, 15.82it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:23:31:37,994 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:31:52,609 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:31:52,657 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.27.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.78it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.88it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.95it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.14it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.76it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.80it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.72it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.98it/s]
 20%|██        | 41/200 [00:05<00:19,  8.01it/s]
 21%|██        | 42/200 [00:05<00:19,  8.03it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.10it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.16it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.20it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.19it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.20it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.24it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.23it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.24it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.18it/s]
 31%|███       | 62/200 [00:08<00:16,  8.17it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.90it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.06it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.09it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.09it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.24it/s]
 41%|████      | 82/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.29it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.37it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.40it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.58it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.63it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.65it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.55it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.72it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.78it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.83it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.85it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.83it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.92it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.96it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.99it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.98it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.14it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.22it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.25it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.36it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.47it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.53it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.55it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.60it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.76it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.79it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.92it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.95it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.97it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.26it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.56it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.83it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 12.02it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.14it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.22it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.33it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.45it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.59it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.69it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.91it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.13it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.31it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.68it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.16it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.49it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.85it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.15it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.50it/s]
100%|██████████| 200/200 [00:21<00:00, 15.80it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:32:14,048 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:32:28,775 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:32:28,824 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.27.attention.wo
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.29it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.64it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.73it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.74it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.87it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.97it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.04it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.15it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.01it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.13it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.19it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.17it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.26it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.50it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.55it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.64it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.91it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.02it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.06it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.08it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.07it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.07it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.14it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.24it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.24it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.29it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.42it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.50it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.59it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.66it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.77it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.84it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.02it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.32it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.54it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.72it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.90it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.03it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.31it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.42it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.51it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.65it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.75it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.08it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.31it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.79it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.12it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.50it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.83it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.09it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.44it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:32:50,324 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:33:05,024 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:33:05,073 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.27.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.74it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.15it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.25it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.52it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.71it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.72it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.75it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.10it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.11it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.14it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.15it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.16it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.89it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.03it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.04it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.15it/s]
 40%|████      | 81/200 [00:10<00:12,  9.20it/s]
 41%|████      | 82/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:12<00:11,  9.41it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.52it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.59it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.61it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.94it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.05it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.08it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.10it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.09it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.17it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.30it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.41it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.49it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.53it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.65it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.79it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.79it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.17it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.40it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.68it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.85it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.21it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.30it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.47it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.61it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.74it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.90it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.19it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.56it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.00it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.31it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.65it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.99it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.29it/s]
100%|██████████| 200/200 [00:21<00:00, 15.65it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:33:26,575 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:33:41,304 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:33:41,353 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.27.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.87it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.70it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.07it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.38it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.69it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.75it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.97it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.11it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.09it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.13it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.15it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.82it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.06it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.10it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.98it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.01it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.06it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.28it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.22it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.24it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.49it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.71it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.74it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.74it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.00it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.04it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.07it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.08it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.06it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.10it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.22it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.42it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.50it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.50it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.53it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.59it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.67it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.70it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.77it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.82it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.85it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.05it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.36it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.59it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.77it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.91it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.03it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.17it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.42it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.67it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.85it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.15it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.33it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.82it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.19it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.51it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.88it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.18it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.45it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:34:02,838 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:34:17,587 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:34:17,635 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.27.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.52it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.70it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.77it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.81it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.82it/s]
 14%|█▍        | 28/200 [00:04<00:21,  7.84it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.84it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.85it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.87it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.88it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.87it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.98it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.00it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.07it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.10it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.08it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.15it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.22it/s]
 30%|███       | 61/200 [00:08<00:16,  8.24it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.70it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.84it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.94it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:14,  8.99it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.29it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.32it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.37it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.25it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.81it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.93it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.07it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.07it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.05it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.04it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.13it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.22it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.30it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.35it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.52it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.58it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.60it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.63it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.61it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.77it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.82it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.84it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.89it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.87it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.92it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.24it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.45it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.73it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.94it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.16it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.30it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.41it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.56it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.65it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.80it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.05it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.36it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.68it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.07it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.45it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.79it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.15it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.48it/s]
100%|██████████| 200/200 [00:21<00:00, 15.84it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:34:39,024 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:34:53,760 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:34:53,809 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.28.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.55it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.56it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.74it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.83it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.69it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.88it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.08it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.75it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.76it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.83it/s]
 14%|█▍        | 28/200 [00:04<00:21,  7.84it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.86it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.89it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.88it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.92it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.95it/s]
 20%|██        | 40/200 [00:05<00:20,  7.97it/s]
 20%|██        | 41/200 [00:05<00:19,  7.96it/s]
 21%|██        | 42/200 [00:05<00:19,  8.02it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.03it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.19it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.23it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.24it/s]
 26%|██▌       | 52/200 [00:07<00:17,  8.24it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.22it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.81it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.97it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.97it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.06it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.12it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.13it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.13it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.12it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.18it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.30it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.25it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:10<00:12,  9.30it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.30it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.33it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.34it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.30it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.61it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.65it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.73it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.81it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.79it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.90it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.90it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.89it/s]
 56%|█████▌    | 111/200 [00:13<00:09,  9.88it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.91it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.93it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.99it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 120/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 121/200 [00:14<00:07,  9.98it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.05it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.14it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.20it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.30it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.37it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.46it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.50it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.58it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.66it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.70it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.83it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.88it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.90it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.90it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.09it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.40it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.66it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.90it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.15it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.37it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.50it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.64it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.86it/s]
 92%|█████████▏| 183/200 [00:19<00:01, 12.99it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.24it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.38it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.94it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.28it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.61it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 15.01it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.36it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.66it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:35:15,202 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:35:30,119 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:35:30,168 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.28.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.26it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.17it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.26it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.61it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.68it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.72it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.79it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.91it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.97it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.08it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.12it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.15it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.11it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.24it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.79it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.28it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.48it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.60it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.66it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.61it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.82it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.89it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.96it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.01it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.00it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.20it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.27it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.37it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.49it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.61it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.68it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.79it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.84it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.85it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.86it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.42it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.63it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.09it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.26it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.36it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.48it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.61it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.73it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.96it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.19it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.56it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.91it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.28it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.62it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.95it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.29it/s]
100%|██████████| 200/200 [00:21<00:00, 15.60it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:35:51,664 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:36:06,372 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:36:06,421 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.28.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.39it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.99it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.00it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.18it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:24,  7.42it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.66it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.77it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.79it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.77it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.00it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.11it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.21it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:17,  8.13it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.53it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.87it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.89it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.01it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.07it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.09it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.11it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.12it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.24it/s]
 41%|████      | 82/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.23it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.26it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.29it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.52it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.68it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.70it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.64it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.72it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.94it/s]
 55%|█████▌    | 110/200 [00:13<00:08, 10.02it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.01it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.03it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.06it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.07it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.15it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.24it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.30it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.40it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.46it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.50it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.60it/s]
 74%|███████▎  | 147/200 [00:17<00:04, 10.66it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.73it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.81it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.82it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.00it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.29it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.53it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.72it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.92it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.29it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.42it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.52it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.62it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.78it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.04it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.33it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.82it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.20it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.51it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.84it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.11it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.46it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:36:27,912 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:36:42,775 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:36:42,825 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.28.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.96it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.25it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.78it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.17it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.28it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.48it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.62it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.74it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.72it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.86it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.18it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.22it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.23it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.23it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:17,  8.14it/s]
 31%|███       | 62/200 [00:08<00:16,  8.18it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.93it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.90it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.98it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.97it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  8.96it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.98it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.08it/s]
 40%|████      | 80/200 [00:10<00:13,  9.12it/s]
 40%|████      | 81/200 [00:10<00:12,  9.17it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.17it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.56it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.71it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.79it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.80it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.80it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.95it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.95it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.98it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.02it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.18it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.28it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.35it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.48it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.52it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.71it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.78it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.76it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.82it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.84it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.20it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.45it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.69it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.07it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.22it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.32it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.61it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.79it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.04it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.34it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.68it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.05it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.35it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.68it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.04it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.35it/s]
100%|██████████| 200/200 [00:21<00:00, 15.61it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:37:04,295 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:37:18,941 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:37:18,990 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.28.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.78it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.16it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.15it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.21it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.68it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.75it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.82it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.14it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.75it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.79it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.83it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.09it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.14it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.22it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.23it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.26it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.54it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.65it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.83it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.01it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.10it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.08it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.08it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.16it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.25it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.24it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.44it/s]
 68%|██████▊   | 137/200 [00:16<00:05, 10.52it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.55it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.55it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.63it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.68it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.76it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.76it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.79it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.83it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.89it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.88it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.04it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.34it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.60it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.82it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 12.00it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.06it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.17it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.30it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.40it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.51it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.72it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.86it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.18it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.39it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.89it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.27it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.63it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.99it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.27it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.65it/s]
100%|██████████| 200/200 [00:21<00:00,  9.47it/s]
2024-12-18:23:37:40,428 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:37:55,113 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:37:55,162 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.29.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.29it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.78it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.88it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.96it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.08it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.14it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.46it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.62it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.73it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.81it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.80it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.81it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.85it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.87it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.85it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.89it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.20it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.21it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.23it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.23it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.39it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.56it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.71it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.83it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.97it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.13it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.12it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.18it/s]
 40%|████      | 80/200 [00:10<00:13,  9.23it/s]
 40%|████      | 81/200 [00:10<00:12,  9.23it/s]
 41%|████      | 82/200 [00:10<00:12,  9.27it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.29it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.30it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.31it/s]
 44%|████▎     | 87/200 [00:10<00:12,  9.30it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.31it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.34it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.38it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.58it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.69it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.72it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.77it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.79it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.77it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.78it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.85it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.89it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.95it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.01it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.03it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.15it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.33it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.47it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.56it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.55it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.59it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.71it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.75it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.81it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.83it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.93it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.96it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.27it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.54it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.80it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.98it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.12it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.21it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.33it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.43it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.58it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.71it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.91it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.12it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.36it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.74it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.20it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.51it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.85it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.19it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.51it/s]
100%|██████████| 200/200 [00:21<00:00, 15.82it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:38:16,527 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:38:31,127 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:38:31,176 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.29.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.37it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.78it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.89it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.11it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.37it/s]
 10%|█         | 21/200 [00:03<00:24,  7.44it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.61it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.67it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.75it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.77it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.99it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.09it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.12it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.13it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.19it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.73it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.75it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.94it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.99it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.03it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 75/200 [00:09<00:13,  8.98it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.00it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.01it/s]
 39%|███▉      | 78/200 [00:10<00:13,  8.98it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.07it/s]
 40%|████      | 80/200 [00:10<00:13,  9.13it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.12it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.16it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.27it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.27it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.25it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.66it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.54it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.64it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.71it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.81it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.89it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.91it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.86it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.88it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.97it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.96it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.99it/s]
 60%|█████▉    | 119/200 [00:14<00:08,  9.98it/s]
 60%|██████    | 120/200 [00:14<00:08,  9.97it/s]
 60%|██████    | 121/200 [00:14<00:07,  9.94it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.04it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.05it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.15it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.24it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.28it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.40it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.49it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.47it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.50it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.54it/s]
 74%|███████▎  | 147/200 [00:17<00:05, 10.60it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.76it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.04it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.30it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.51it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.90it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.03it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.16it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.30it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.43it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.53it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.68it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.76it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.09it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.29it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.78it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.08it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.47it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.79it/s]
 98%|█████████▊| 197/200 [00:21<00:00, 15.10it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.47it/s]
100%|██████████| 200/200 [00:21<00:00,  9.43it/s]
2024-12-18:23:38:52,705 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:39:07,349 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:39:07,398 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.29.feed_forward.w1
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.40it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.26it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.48it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.78it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.85it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.92it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.04it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.16it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.26it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.60it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.69it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.73it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.76it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.77it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.88it/s]
 20%|██        | 41/200 [00:05<00:20,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.10it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.12it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.12it/s]
 30%|███       | 60/200 [00:08<00:17,  8.14it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.64it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.76it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.86it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.91it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.00it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.01it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.03it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.01it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.02it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.06it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:13,  9.14it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.15it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.18it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.16it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.21it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.32it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.51it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.59it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.63it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.55it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.69it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.68it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.68it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.86it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.87it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.94it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.94it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.01it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.01it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.05it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.08it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.19it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.51it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.52it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.64it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.73it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.82it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.87it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.86it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.43it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.66it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.83it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.07it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.36it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.59it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.75it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.02it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.28it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.60it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.05it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.36it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.67it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.02it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.33it/s]
100%|██████████| 200/200 [00:21<00:00, 15.62it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:39:28,888 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:39:43,558 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:39:43,607 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.29.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.49it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.69it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.11it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.78it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.87it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.11it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.18it/s]
  9%|▉         | 18/200 [00:02<00:24,  7.28it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.49it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.80it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.85it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.78it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.80it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.02it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.00it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.07it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.15it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.15it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.10it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.17it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:17,  8.16it/s]
 31%|███       | 62/200 [00:08<00:16,  8.15it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.33it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.46it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.90it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.92it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.09it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.03it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:12,  9.21it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.27it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.27it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.19it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.35it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.37it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.47it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.53it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.58it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.67it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.71it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.70it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.69it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.76it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.83it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.87it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.92it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.93it/s]
 56%|█████▋    | 113/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.06it/s]
 60%|█████▉    | 119/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.10it/s]
 62%|██████▏   | 123/200 [00:14<00:07, 10.11it/s]
 62%|██████▎   | 125/200 [00:14<00:07, 10.09it/s]
 64%|██████▎   | 127/200 [00:15<00:07, 10.11it/s]
 64%|██████▍   | 129/200 [00:15<00:06, 10.19it/s]
 66%|██████▌   | 131/200 [00:15<00:06, 10.27it/s]
 66%|██████▋   | 133/200 [00:15<00:06, 10.26it/s]
 68%|██████▊   | 135/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 137/200 [00:16<00:06, 10.38it/s]
 70%|██████▉   | 139/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 141/200 [00:16<00:05, 10.49it/s]
 72%|███████▏  | 143/200 [00:16<00:05, 10.52it/s]
 72%|███████▎  | 145/200 [00:16<00:05, 10.57it/s]
 74%|███████▎  | 147/200 [00:16<00:04, 10.62it/s]
 74%|███████▍  | 149/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 151/200 [00:17<00:04, 10.78it/s]
 76%|███████▋  | 153/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 155/200 [00:17<00:04, 10.78it/s]
 78%|███████▊  | 157/200 [00:17<00:03, 10.80it/s]
 80%|███████▉  | 159/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 161/200 [00:18<00:03, 11.02it/s]
 82%|████████▏ | 163/200 [00:18<00:03, 11.33it/s]
 82%|████████▎ | 165/200 [00:18<00:03, 11.55it/s]
 84%|████████▎ | 167/200 [00:18<00:02, 11.77it/s]
 84%|████████▍ | 169/200 [00:18<00:02, 11.93it/s]
 86%|████████▌ | 171/200 [00:19<00:02, 12.04it/s]
 86%|████████▋ | 173/200 [00:19<00:02, 12.17it/s]
 88%|████████▊ | 175/200 [00:19<00:02, 12.28it/s]
 88%|████████▊ | 177/200 [00:19<00:01, 12.38it/s]
 90%|████████▉ | 179/200 [00:19<00:01, 12.54it/s]
 90%|█████████ | 181/200 [00:19<00:01, 12.70it/s]
 92%|█████████▏| 183/200 [00:20<00:01, 12.86it/s]
 92%|█████████▎| 185/200 [00:20<00:01, 13.16it/s]
 94%|█████████▎| 187/200 [00:20<00:00, 13.45it/s]
 94%|█████████▍| 189/200 [00:20<00:00, 13.84it/s]
 96%|█████████▌| 191/200 [00:20<00:00, 14.17it/s]
 96%|█████████▋| 193/200 [00:20<00:00, 14.55it/s]
 98%|█████████▊| 195/200 [00:20<00:00, 14.87it/s]
 98%|█████████▊| 197/200 [00:20<00:00, 15.13it/s]
100%|█████████▉| 199/200 [00:21<00:00, 15.50it/s]
100%|██████████| 200/200 [00:21<00:00,  9.46it/s]
2024-12-18:23:40:05,085 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:40:19,730 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:40:19,779 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.29.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.66it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.87it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.01it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.09it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.17it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.54it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.78it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.81it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.84it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.81it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.82it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 36/200 [00:05<00:21,  7.79it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.04it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.09it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.10it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.18it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.13it/s]
 30%|███       | 60/200 [00:08<00:17,  8.17it/s]
 30%|███       | 61/200 [00:08<00:16,  8.23it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.38it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.54it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.71it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.83it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.92it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.11it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.17it/s]
 40%|████      | 80/200 [00:10<00:13,  9.20it/s]
 40%|████      | 81/200 [00:10<00:12,  9.23it/s]
 41%|████      | 82/200 [00:10<00:12,  9.23it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.28it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.25it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.31it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.25it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.34it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.53it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.57it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.67it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.63it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.75it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.93it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.98it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.96it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.05it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.06it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.06it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.03it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.13it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.19it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.28it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.29it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.35it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.41it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.52it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.57it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.56it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.60it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.63it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.71it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.79it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.83it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.84it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.90it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.92it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.25it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.47it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.74it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.93it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.06it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.14it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.30it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.42it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.57it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.67it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.06it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.34it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.71it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.09it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.45it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.80it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.14it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.48it/s]
100%|██████████| 200/200 [00:21<00:00, 15.80it/s]
100%|██████████| 200/200 [00:21<00:00,  9.48it/s]
2024-12-18:23:40:41,175 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:40:56,115 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:40:56,164 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.30.attention.wqkv
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.41it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.68it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.01it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.14it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.79it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.88it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.95it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.06it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.14it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.17it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.24it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.44it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.73it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.79it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.82it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.83it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.87it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.82it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.87it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.87it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:20,  7.87it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.86it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.87it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.90it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  8.00it/s]
 21%|██        | 42/200 [00:05<00:19,  8.02it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.03it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.06it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.08it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.19it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.21it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.21it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.22it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.23it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.23it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.21it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.22it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.41it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.56it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.82it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.84it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.92it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.10it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.06it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.19it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.28it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.27it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.30it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.29it/s]
 44%|████▎     | 87/200 [00:10<00:12,  9.30it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.33it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.28it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.37it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.36it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.49it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.53it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.59it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.63it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.72it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.73it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.71it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.91it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.99it/s]
 56%|█████▌    | 111/200 [00:13<00:08, 10.00it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.00it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.02it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.03it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.02it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.09it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.18it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.48it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.50it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.55it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.53it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.59it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.71it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.75it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.80it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.78it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.84it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.92it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.25it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.53it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.80it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.98it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.11it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.18it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.32it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.41it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.60it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.76it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.93it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.12it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.38it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.73it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.09it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.49it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.89it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.18it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.49it/s]
100%|██████████| 200/200 [00:21<00:00, 15.80it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:41:17,537 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:41:32,325 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:41:32,374 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.30.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:37,  5.35it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.80it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.25it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.50it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.68it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.76it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.84it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.98it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.07it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.17it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.25it/s]
 10%|█         | 20/200 [00:03<00:24,  7.39it/s]
 10%|█         | 21/200 [00:03<00:24,  7.42it/s]
 11%|█         | 22/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.53it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.63it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.73it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.76it/s]
 14%|█▍        | 29/200 [00:04<00:22,  7.77it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.79it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.74it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.82it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.81it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.84it/s]
 20%|██        | 41/200 [00:05<00:20,  7.93it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.05it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.11it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.20it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.19it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.13it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.35it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.66it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.93it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.97it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.04it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.05it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.08it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.10it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.16it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.18it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.20it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.23it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.39it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.52it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.57it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.62it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.55it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.74it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.73it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.79it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.78it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.90it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.92it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.96it/s]
 58%|█████▊    | 116/200 [00:14<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.97it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.97it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.02it/s]
 60%|██████    | 121/200 [00:14<00:07, 10.00it/s]
 61%|██████    | 122/200 [00:14<00:07,  9.99it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.15it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.20it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.26it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.25it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.32it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.40it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.43it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.47it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.46it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.55it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.64it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.70it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.74it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.82it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.84it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.86it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.88it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.44it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.70it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.87it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.99it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.05it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.21it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.32it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.41it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.57it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.72it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.94it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.25it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.53it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.98it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.33it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.61it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.98it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.29it/s]
100%|██████████| 200/200 [00:21<00:00, 15.60it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:41:53,885 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:42:08,675 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:42:08,724 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.30.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.50it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.12it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.21it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.65it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.81it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.86it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.08it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.28it/s]
 10%|█         | 20/200 [00:03<00:24,  7.42it/s]
 10%|█         | 21/200 [00:03<00:23,  7.48it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.58it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.66it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.71it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.78it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.73it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.79it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.82it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.88it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.94it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.07it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.03it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.07it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.15it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.17it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.12it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.18it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.18it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.15it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.26it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.38it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.60it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.85it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.85it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.88it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.87it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.89it/s]
 36%|███▌      | 72/200 [00:09<00:14,  8.97it/s]
 36%|███▋      | 73/200 [00:09<00:14,  8.99it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.05it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.05it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.11it/s]
 40%|████      | 80/200 [00:10<00:13,  9.13it/s]
 40%|████      | 81/200 [00:10<00:13,  9.11it/s]
 41%|████      | 82/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.26it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.24it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.16it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.22it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.22it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.29it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.52it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.54it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.58it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.63it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.69it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:10,  9.67it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.70it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.72it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.87it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.99it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.04it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.02it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.03it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.07it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.16it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.24it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.24it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.34it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.38it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.66it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.74it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.79it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.83it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.80it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.85it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.18it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.38it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.68it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.85it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.07it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.33it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.49it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.61it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.69it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.96it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.24it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.57it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.00it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.31it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.67it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.95it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.28it/s]
100%|██████████| 200/200 [00:21<00:00, 15.64it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:42:30,234 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:42:44,918 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:42:44,967 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.30.feed_forward.w3
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.52it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.70it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.28it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.14it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.24it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.26it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.61it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.69it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.74it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.75it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.79it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.78it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.84it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.83it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.83it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.84it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.93it/s]
 20%|██        | 40/200 [00:05<00:20,  7.95it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.05it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.08it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.15it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.18it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.18it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.16it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.13it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.20it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.21it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.21it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.37it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.50it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.81it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.94it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.96it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.03it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.12it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.09it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.17it/s]
 40%|████      | 81/200 [00:10<00:13,  9.10it/s]
 41%|████      | 82/200 [00:10<00:12,  9.19it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.17it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.21it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.22it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.24it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.23it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.33it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.53it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.56it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.56it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.50it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.71it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.74it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.76it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.71it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.82it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.83it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.87it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▋    | 113/200 [00:13<00:08, 10.00it/s]
 57%|█████▊    | 115/200 [00:13<00:08, 10.02it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.00it/s]
 58%|█████▊    | 117/200 [00:14<00:08,  9.99it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.04it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.03it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.06it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.12it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.21it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.45it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.48it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.51it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.55it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.71it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.73it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.76it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.77it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.83it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.87it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.86it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.20it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.46it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.72it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.87it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.97it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.09it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.24it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.34it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.61it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.80it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.01it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.30it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.66it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.01it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.33it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.67it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.02it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.36it/s]
100%|██████████| 200/200 [00:21<00:00, 15.68it/s]
100%|██████████| 200/200 [00:21<00:00,  9.46it/s]
2024-12-18:23:43:06,433 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:43:21,373 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:43:21,422 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.30.feed_forward.w2
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.38it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.55it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.98it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.26it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.51it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.69it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.79it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.86it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.94it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.13it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.20it/s]
  9%|▉         | 18/200 [00:02<00:24,  7.29it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.30it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.51it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.69it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.75it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.79it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.82it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.80it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.84it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.85it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.86it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.94it/s]
 20%|██        | 40/200 [00:05<00:20,  7.98it/s]
 20%|██        | 41/200 [00:05<00:19,  7.99it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.99it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.07it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.10it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.13it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.14it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.12it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.16it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.19it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.14it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.16it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.17it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.18it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.25it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.42it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.56it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.71it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.78it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.04it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.06it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.10it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.11it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.16it/s]
 40%|████      | 80/200 [00:10<00:13,  9.21it/s]
 40%|████      | 81/200 [00:10<00:12,  9.21it/s]
 41%|████      | 82/200 [00:10<00:12,  9.25it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.20it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.21it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.20it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.29it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.30it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.32it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.30it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.30it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.40it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.61it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.64it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.65it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.75it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.77it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.78it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.89it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.92it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.08it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.12it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.09it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.07it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.13it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.22it/s]
 64%|██████▍   | 128/200 [00:15<00:06, 10.30it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.28it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.39it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.50it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.56it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.61it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.64it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.79it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.82it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.82it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.86it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.86it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.90it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.94it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.21it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.48it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.76it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.96it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.08it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.14it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.27it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.39it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.55it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.71it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.77it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.01it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.29it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.66it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.06it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.34it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.77it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.09it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.40it/s]
100%|██████████| 200/200 [00:21<00:00, 15.73it/s]
100%|██████████| 200/200 [00:21<00:00,  9.49it/s]
2024-12-18:23:43:42,830 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:43:57,481 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:43:57,529 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.31.attention.wqkv
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.51it/s]
  1%|          | 2/200 [00:00<00:36,  5.36it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.54it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.71it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.81it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.90it/s]
  4%|▎         | 7/200 [00:01<00:32,  5.97it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.13it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.49it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.67it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.77it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.83it/s]
  7%|▋         | 14/200 [00:02<00:27,  6.86it/s]
  8%|▊         | 15/200 [00:02<00:26,  6.99it/s]
  8%|▊         | 16/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.10it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.19it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.29it/s]
 10%|█         | 20/200 [00:03<00:24,  7.43it/s]
 10%|█         | 21/200 [00:03<00:23,  7.52it/s]
 11%|█         | 22/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.62it/s]
 12%|█▏        | 24/200 [00:03<00:22,  7.67it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.72it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.79it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.79it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.83it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.85it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.86it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.86it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.86it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.91it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.95it/s]
 20%|██        | 40/200 [00:05<00:20,  7.94it/s]
 20%|██        | 41/200 [00:05<00:19,  7.95it/s]
 21%|██        | 42/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 43/200 [00:05<00:19,  8.01it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:18,  8.12it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.17it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.17it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.20it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.22it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.20it/s]
 26%|██▋       | 53/200 [00:07<00:17,  8.19it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.16it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.19it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.22it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.22it/s]
 30%|███       | 60/200 [00:08<00:17,  8.22it/s]
 30%|███       | 61/200 [00:08<00:16,  8.22it/s]
 31%|███       | 62/200 [00:08<00:16,  8.24it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.40it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.52it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.68it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.82it/s]
 34%|███▎      | 67/200 [00:08<00:14,  8.88it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.94it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.98it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.03it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.05it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.11it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.14it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.09it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.08it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.15it/s]
 40%|████      | 80/200 [00:10<00:13,  9.21it/s]
 40%|████      | 81/200 [00:10<00:12,  9.22it/s]
 41%|████      | 82/200 [00:10<00:12,  9.26it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.28it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.24it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.30it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.27it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.26it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.31it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.35it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.38it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.36it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.37it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.50it/s]
 48%|████▊     | 95/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.60it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.59it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.70it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.75it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.75it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.76it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.77it/s]
 53%|█████▎    | 106/200 [00:12<00:09,  9.84it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.94it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.97it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.97it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:13<00:08, 10.02it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.04it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.02it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.02it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:14<00:07, 10.15it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.24it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.34it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.38it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.48it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.53it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.57it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.55it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.59it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.72it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.77it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.78it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.79it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.85it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.90it/s]
 79%|███████▉  | 158/200 [00:17<00:03, 10.93it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.96it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.26it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.56it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.82it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 12.00it/s]
 85%|████████▌ | 170/200 [00:18<00:02, 12.13it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.22it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.34it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.45it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.62it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.73it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.92it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.09it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.38it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.77it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.20it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.49it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.83it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.16it/s]
 99%|█████████▉| 198/200 [00:20<00:00, 15.49it/s]
100%|██████████| 200/200 [00:21<00:00, 15.81it/s]
100%|██████████| 200/200 [00:21<00:00,  9.50it/s]
2024-12-18:23:44:18,900 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:44:34,003 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:44:34,052 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.31.attention.wo
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:36,  5.52it/s]
  1%|          | 2/200 [00:00<00:36,  5.43it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.53it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.72it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.79it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.91it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.02it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.18it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.27it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.45it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.64it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.75it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.84it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.93it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.05it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.12it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.23it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:23,  7.47it/s]
 11%|█         | 22/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.59it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.74it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.78it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.80it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.79it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.85it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.83it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.87it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.92it/s]
 20%|██        | 40/200 [00:05<00:20,  7.96it/s]
 20%|██        | 41/200 [00:05<00:20,  7.94it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.97it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.05it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.09it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.16it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.20it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.19it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.15it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.11it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.22it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.21it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.19it/s]
 30%|███       | 60/200 [00:08<00:17,  8.20it/s]
 30%|███       | 61/200 [00:08<00:16,  8.20it/s]
 31%|███       | 62/200 [00:08<00:16,  8.20it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.34it/s]
 32%|███▏      | 64/200 [00:08<00:15,  8.51it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.69it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.80it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.86it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.95it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.96it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.02it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:13,  9.08it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.06it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.09it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.04it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.00it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.10it/s]
 40%|████      | 80/200 [00:10<00:13,  9.08it/s]
 40%|████      | 81/200 [00:10<00:12,  9.18it/s]
 41%|████      | 82/200 [00:10<00:12,  9.22it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.24it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.26it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.15it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.16it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.13it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.20it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.23it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.33it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.34it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.35it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.43it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.45it/s]
 48%|████▊     | 96/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.51it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.56it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.65it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.60it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.74it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.73it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.70it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.84it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.95it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.95it/s]
 56%|█████▌    | 112/200 [00:13<00:08, 10.01it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.03it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.05it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.08it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.08it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.06it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.08it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.07it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.17it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.26it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.26it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.33it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.46it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.51it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.66it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.75it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.84it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.82it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.87it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.19it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.42it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.96it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.07it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.25it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.36it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.50it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.63it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.68it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.95it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.19it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.50it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.93it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.24it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.52it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 14.86it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.23it/s]
100%|██████████| 200/200 [00:21<00:00, 15.53it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:44:55,530 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:45:10,227 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:45:10,275 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 70.0
Results for layer: layers.31.feed_forward.w1
Accuracy: 70.0
Improvement over INT4 baseline: 2.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.53it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.76it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.82it/s]
  3%|▎         | 6/200 [00:01<00:33,  5.88it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.17it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.23it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.47it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:27,  6.72it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.82it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.90it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.02it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.13it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.24it/s]
 10%|█         | 20/200 [00:03<00:24,  7.40it/s]
 10%|█         | 21/200 [00:03<00:23,  7.50it/s]
 11%|█         | 22/200 [00:03<00:23,  7.55it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.64it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.71it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.72it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.77it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.77it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.81it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.77it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.80it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.81it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.83it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.78it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.85it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.89it/s]
 20%|██        | 40/200 [00:05<00:20,  7.85it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.95it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 44/200 [00:06<00:19,  7.98it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.06it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.13it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.16it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.13it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.12it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.13it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.17it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.19it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.20it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.10it/s]
 30%|███       | 60/200 [00:08<00:17,  8.15it/s]
 30%|███       | 61/200 [00:08<00:16,  8.19it/s]
 31%|███       | 62/200 [00:08<00:16,  8.23it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.49it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.65it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.76it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.80it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.89it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.86it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.95it/s]
 36%|███▌      | 71/200 [00:09<00:14,  8.98it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.04it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.05it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.06it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.16it/s]
 40%|████      | 81/200 [00:10<00:12,  9.16it/s]
 41%|████      | 82/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.20it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.22it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.23it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.25it/s]
 44%|████▍     | 89/200 [00:11<00:11,  9.31it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.31it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.29it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.31it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.32it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.42it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.47it/s]
 48%|████▊     | 96/200 [00:12<00:10,  9.54it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.60it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.57it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.64it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.68it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.71it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.72it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.68it/s]
 53%|█████▎    | 106/200 [00:13<00:09,  9.76it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.86it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.88it/s]
 56%|█████▌    | 111/200 [00:13<00:08,  9.94it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.94it/s]
 57%|█████▋    | 114/200 [00:13<00:08,  9.99it/s]
 57%|█████▊    | 115/200 [00:13<00:08,  9.99it/s]
 58%|█████▊    | 117/200 [00:14<00:08, 10.00it/s]
 59%|█████▉    | 118/200 [00:14<00:08,  9.99it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.01it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.01it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.04it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.04it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.10it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.22it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.27it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.31it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.39it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.41it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.50it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.54it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.53it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.63it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.66it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.77it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.80it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.78it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.78it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.82it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.16it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.40it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.65it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.84it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.96it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.06it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.19it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.27it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.42it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.59it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.72it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 12.90it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.21it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.60it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 13.99it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.35it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.68it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.01it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.33it/s]
100%|██████████| 200/200 [00:21<00:00, 15.62it/s]
100%|██████████| 200/200 [00:21<00:00,  9.44it/s]
2024-12-18:23:45:31,783 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:45:46,453 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:45:46,502 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.31.feed_forward.w3
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s]
  0%|          | 1/200 [00:00<00:35,  5.54it/s]
  1%|          | 2/200 [00:00<00:36,  5.42it/s]
  2%|▏         | 3/200 [00:00<00:35,  5.57it/s]
  2%|▏         | 4/200 [00:00<00:34,  5.75it/s]
  2%|▎         | 5/200 [00:00<00:33,  5.84it/s]
  3%|▎         | 6/200 [00:01<00:32,  5.89it/s]
  4%|▎         | 7/200 [00:01<00:32,  6.00it/s]
  4%|▍         | 8/200 [00:01<00:31,  6.15it/s]
  4%|▍         | 9/200 [00:01<00:30,  6.22it/s]
  5%|▌         | 10/200 [00:01<00:29,  6.46it/s]
  6%|▌         | 11/200 [00:01<00:28,  6.62it/s]
  6%|▌         | 12/200 [00:01<00:28,  6.71it/s]
  6%|▋         | 13/200 [00:02<00:27,  6.80it/s]
  7%|▋         | 14/200 [00:02<00:26,  6.91it/s]
  8%|▊         | 15/200 [00:02<00:26,  7.03it/s]
  8%|▊         | 16/200 [00:02<00:25,  7.10it/s]
  8%|▊         | 17/200 [00:02<00:25,  7.12it/s]
  9%|▉         | 18/200 [00:02<00:25,  7.20it/s]
 10%|▉         | 19/200 [00:02<00:24,  7.27it/s]
 10%|█         | 20/200 [00:03<00:24,  7.41it/s]
 10%|█         | 21/200 [00:03<00:24,  7.46it/s]
 11%|█         | 22/200 [00:03<00:23,  7.56it/s]
 12%|█▏        | 23/200 [00:03<00:23,  7.57it/s]
 12%|█▏        | 24/200 [00:03<00:23,  7.65it/s]
 12%|█▎        | 25/200 [00:03<00:22,  7.65it/s]
 13%|█▎        | 26/200 [00:03<00:22,  7.72it/s]
 14%|█▎        | 27/200 [00:03<00:22,  7.76it/s]
 14%|█▍        | 28/200 [00:04<00:22,  7.75it/s]
 14%|█▍        | 29/200 [00:04<00:21,  7.78it/s]
 15%|█▌        | 30/200 [00:04<00:21,  7.76it/s]
 16%|█▌        | 31/200 [00:04<00:21,  7.80it/s]
 16%|█▌        | 32/200 [00:04<00:21,  7.78it/s]
 16%|█▋        | 33/200 [00:04<00:21,  7.81it/s]
 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s]
 18%|█▊        | 35/200 [00:04<00:21,  7.79it/s]
 18%|█▊        | 36/200 [00:05<00:20,  7.82it/s]
 18%|█▊        | 37/200 [00:05<00:20,  7.81it/s]
 19%|█▉        | 38/200 [00:05<00:20,  7.88it/s]
 20%|█▉        | 39/200 [00:05<00:20,  7.91it/s]
 20%|██        | 40/200 [00:05<00:20,  7.93it/s]
 20%|██        | 41/200 [00:05<00:20,  7.92it/s]
 21%|██        | 42/200 [00:05<00:19,  7.96it/s]
 22%|██▏       | 43/200 [00:05<00:19,  7.98it/s]
 22%|██▏       | 44/200 [00:06<00:19,  8.03it/s]
 22%|██▎       | 45/200 [00:06<00:19,  8.02it/s]
 23%|██▎       | 46/200 [00:06<00:19,  8.09it/s]
 24%|██▎       | 47/200 [00:06<00:18,  8.11it/s]
 24%|██▍       | 48/200 [00:06<00:18,  8.10it/s]
 24%|██▍       | 49/200 [00:06<00:18,  8.13it/s]
 25%|██▌       | 50/200 [00:06<00:18,  8.14it/s]
 26%|██▌       | 51/200 [00:06<00:18,  8.17it/s]
 26%|██▌       | 52/200 [00:07<00:18,  8.16it/s]
 26%|██▋       | 53/200 [00:07<00:18,  8.09it/s]
 27%|██▋       | 54/200 [00:07<00:17,  8.15it/s]
 28%|██▊       | 55/200 [00:07<00:17,  8.18it/s]
 28%|██▊       | 56/200 [00:07<00:17,  8.17it/s]
 28%|██▊       | 57/200 [00:07<00:17,  8.17it/s]
 29%|██▉       | 58/200 [00:07<00:17,  8.18it/s]
 30%|██▉       | 59/200 [00:07<00:17,  8.20it/s]
 30%|███       | 60/200 [00:08<00:17,  8.19it/s]
 30%|███       | 61/200 [00:08<00:17,  8.16it/s]
 31%|███       | 62/200 [00:08<00:16,  8.16it/s]
 32%|███▏      | 63/200 [00:08<00:16,  8.36it/s]
 32%|███▏      | 64/200 [00:08<00:16,  8.47it/s]
 32%|███▎      | 65/200 [00:08<00:15,  8.63it/s]
 33%|███▎      | 66/200 [00:08<00:15,  8.74it/s]
 34%|███▎      | 67/200 [00:08<00:15,  8.83it/s]
 34%|███▍      | 68/200 [00:08<00:14,  8.91it/s]
 34%|███▍      | 69/200 [00:09<00:14,  8.94it/s]
 35%|███▌      | 70/200 [00:09<00:14,  8.99it/s]
 36%|███▌      | 71/200 [00:09<00:14,  9.00it/s]
 36%|███▌      | 72/200 [00:09<00:14,  9.02it/s]
 36%|███▋      | 73/200 [00:09<00:14,  9.04it/s]
 37%|███▋      | 74/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 75/200 [00:09<00:13,  9.07it/s]
 38%|███▊      | 76/200 [00:09<00:13,  9.08it/s]
 38%|███▊      | 77/200 [00:09<00:13,  9.07it/s]
 39%|███▉      | 78/200 [00:10<00:13,  9.07it/s]
 40%|███▉      | 79/200 [00:10<00:13,  9.14it/s]
 40%|████      | 80/200 [00:10<00:13,  9.18it/s]
 40%|████      | 81/200 [00:10<00:12,  9.19it/s]
 41%|████      | 82/200 [00:10<00:12,  9.18it/s]
 42%|████▏     | 83/200 [00:10<00:12,  9.21it/s]
 42%|████▏     | 84/200 [00:10<00:12,  9.17it/s]
 42%|████▎     | 85/200 [00:10<00:12,  9.24it/s]
 43%|████▎     | 86/200 [00:10<00:12,  9.25it/s]
 44%|████▎     | 87/200 [00:11<00:12,  9.24it/s]
 44%|████▍     | 88/200 [00:11<00:12,  9.28it/s]
 44%|████▍     | 89/200 [00:11<00:12,  9.23it/s]
 45%|████▌     | 90/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 91/200 [00:11<00:11,  9.27it/s]
 46%|████▌     | 92/200 [00:11<00:11,  9.28it/s]
 46%|████▋     | 93/200 [00:11<00:11,  9.31it/s]
 47%|████▋     | 94/200 [00:11<00:11,  9.44it/s]
 48%|████▊     | 95/200 [00:11<00:11,  9.46it/s]
 48%|████▊     | 96/200 [00:11<00:10,  9.55it/s]
 48%|████▊     | 97/200 [00:12<00:10,  9.58it/s]
 49%|████▉     | 98/200 [00:12<00:10,  9.61it/s]
 50%|████▉     | 99/200 [00:12<00:10,  9.61it/s]
 50%|█████     | 100/200 [00:12<00:10,  9.60it/s]
 50%|█████     | 101/200 [00:12<00:10,  9.62it/s]
 51%|█████     | 102/200 [00:12<00:10,  9.68it/s]
 52%|█████▏    | 103/200 [00:12<00:09,  9.73it/s]
 52%|█████▏    | 104/200 [00:12<00:09,  9.75it/s]
 52%|█████▎    | 105/200 [00:12<00:09,  9.76it/s]
 54%|█████▎    | 107/200 [00:13<00:09,  9.87it/s]
 54%|█████▍    | 108/200 [00:13<00:09,  9.90it/s]
 55%|█████▍    | 109/200 [00:13<00:09,  9.88it/s]
 55%|█████▌    | 110/200 [00:13<00:09,  9.88it/s]
 56%|█████▌    | 112/200 [00:13<00:08,  9.93it/s]
 57%|█████▋    | 114/200 [00:13<00:08, 10.00it/s]
 58%|█████▊    | 116/200 [00:14<00:08, 10.05it/s]
 59%|█████▉    | 118/200 [00:14<00:08, 10.07it/s]
 60%|██████    | 120/200 [00:14<00:07, 10.08it/s]
 61%|██████    | 122/200 [00:14<00:07, 10.09it/s]
 62%|██████▏   | 124/200 [00:14<00:07, 10.15it/s]
 63%|██████▎   | 126/200 [00:15<00:07, 10.14it/s]
 64%|██████▍   | 128/200 [00:15<00:07, 10.20it/s]
 65%|██████▌   | 130/200 [00:15<00:06, 10.27it/s]
 66%|██████▌   | 132/200 [00:15<00:06, 10.28it/s]
 67%|██████▋   | 134/200 [00:15<00:06, 10.36it/s]
 68%|██████▊   | 136/200 [00:15<00:06, 10.40it/s]
 69%|██████▉   | 138/200 [00:16<00:05, 10.48it/s]
 70%|███████   | 140/200 [00:16<00:05, 10.47it/s]
 71%|███████   | 142/200 [00:16<00:05, 10.52it/s]
 72%|███████▏  | 144/200 [00:16<00:05, 10.52it/s]
 73%|███████▎  | 146/200 [00:16<00:05, 10.62it/s]
 74%|███████▍  | 148/200 [00:17<00:04, 10.67it/s]
 75%|███████▌  | 150/200 [00:17<00:04, 10.72it/s]
 76%|███████▌  | 152/200 [00:17<00:04, 10.74it/s]
 77%|███████▋  | 154/200 [00:17<00:04, 10.81it/s]
 78%|███████▊  | 156/200 [00:17<00:04, 10.84it/s]
 79%|███████▉  | 158/200 [00:18<00:03, 10.82it/s]
 80%|████████  | 160/200 [00:18<00:03, 10.87it/s]
 81%|████████  | 162/200 [00:18<00:03, 11.21it/s]
 82%|████████▏ | 164/200 [00:18<00:03, 11.48it/s]
 83%|████████▎ | 166/200 [00:18<00:02, 11.67it/s]
 84%|████████▍ | 168/200 [00:18<00:02, 11.85it/s]
 85%|████████▌ | 170/200 [00:19<00:02, 11.98it/s]
 86%|████████▌ | 172/200 [00:19<00:02, 12.08it/s]
 87%|████████▋ | 174/200 [00:19<00:02, 12.23it/s]
 88%|████████▊ | 176/200 [00:19<00:01, 12.36it/s]
 89%|████████▉ | 178/200 [00:19<00:01, 12.51it/s]
 90%|█████████ | 180/200 [00:19<00:01, 12.66it/s]
 91%|█████████ | 182/200 [00:19<00:01, 12.82it/s]
 92%|█████████▏| 184/200 [00:20<00:01, 13.07it/s]
 93%|█████████▎| 186/200 [00:20<00:01, 13.31it/s]
 94%|█████████▍| 188/200 [00:20<00:00, 13.63it/s]
 95%|█████████▌| 190/200 [00:20<00:00, 14.06it/s]
 96%|█████████▌| 192/200 [00:20<00:00, 14.37it/s]
 97%|█████████▋| 194/200 [00:20<00:00, 14.69it/s]
 98%|█████████▊| 196/200 [00:20<00:00, 15.02it/s]
 99%|█████████▉| 198/200 [00:21<00:00, 15.28it/s]
100%|██████████| 200/200 [00:21<00:00, 15.56it/s]
100%|██████████| 200/200 [00:21<00:00,  9.45it/s]
2024-12-18:23:46:07,974 INFO     [huggingface.py:120] Using device 'cuda'
2024-12-18:23:46:22,699 INFO     [task.py:355] Building contexts for task on rank 0...
2024-12-18:23:46:22,748 INFO     [evaluator.py:319] Running loglikelihood requests
hellaswag[acc_norm]: 68.0
Results for layer: layers.31.feed_forward.w2
Accuracy: 68.0
Improvement over INT4 baseline: 0.0

  0%|          | 0/200 [00:00<?, ?it/s][A

  0%|          | 1/200 [00:00<00:41,  4.85it/s][A

  1%|          | 2/200 [00:00<00:38,  5.17it/s][A

  2%|▏         | 3/200 [00:00<00:36,  5.44it/s][A

  2%|▏         | 4/200 [00:00<00:34,  5.67it/s][A

  2%|▎         | 5/200 [00:00<00:33,  5.79it/s][A

  3%|▎         | 6/200 [00:01<00:32,  5.92it/s][A

  4%|▎         | 7/200 [00:01<00:32,  5.99it/s][A

  4%|▍         | 8/200 [00:01<00:31,  6.12it/s][A

  4%|▍         | 9/200 [00:01<00:30,  6.23it/s][A

  5%|▌         | 10/200 [00:01<00:29,  6.45it/s][A

  6%|▌         | 11/200 [00:01<00:28,  6.61it/s][A

  6%|▌         | 12/200 [00:01<00:27,  6.74it/s][A

  6%|▋         | 13/200 [00:02<00:27,  6.81it/s][A

  7%|▋         | 14/200 [00:02<00:27,  6.88it/s][A

  8%|▊         | 15/200 [00:02<00:26,  6.96it/s][A

  8%|▊         | 16/200 [00:02<00:26,  7.03it/s][A

  8%|▊         | 17/200 [00:02<00:25,  7.10it/s][A

  9%|▉         | 18/200 [00:02<00:25,  7.21it/s][A

 10%|▉         | 19/200 [00:02<00:24,  7.28it/s][A

 10%|█         | 20/200 [00:03<00:24,  7.34it/s][A

 10%|█         | 21/200 [00:03<00:24,  7.37it/s][A

 11%|█         | 22/200 [00:03<00:23,  7.42it/s][A

 12%|█▏        | 23/200 [00:03<00:23,  7.48it/s][A

 12%|█▏        | 24/200 [00:03<00:23,  7.60it/s][A

 12%|█▎        | 25/200 [00:03<00:22,  7.70it/s][A

 13%|█▎        | 26/200 [00:03<00:22,  7.76it/s][A

 14%|█▎        | 27/200 [00:03<00:22,  7.79it/s][A

 14%|█▍        | 28/200 [00:04<00:22,  7.79it/s][A

 14%|█▍        | 29/200 [00:04<00:21,  7.82it/s][A

 15%|█▌        | 30/200 [00:04<00:21,  7.82it/s][A

 16%|█▌        | 31/200 [00:04<00:21,  7.84it/s][A

 16%|█▌        | 32/200 [00:04<00:21,  7.84it/s][A

 16%|█▋        | 33/200 [00:04<00:21,  7.84it/s][A

 17%|█▋        | 34/200 [00:04<00:21,  7.84it/s][A

 18%|█▊        | 35/200 [00:04<00:21,  7.82it/s][A

 18%|█▊        | 36/200 [00:05<00:21,  7.81it/s][A

 18%|█▊        | 37/200 [00:05<00:20,  7.80it/s][A

 19%|█▉        | 38/200 [00:05<00:20,  7.83it/s][A

 20%|█▉        | 39/200 [00:05<00:20,  7.87it/s][A

 20%|██        | 40/200 [00:05<00:20,  7.88it/s][A

 20%|██        | 41/200 [00:05<00:20,  7.90it/s][A

 21%|██        | 42/200 [00:05<00:19,  7.91it/s][A

 22%|██▏       | 43/200 [00:05<00:19,  7.92it/s][A

 22%|██▏       | 44/200 [00:06<00:19,  7.94it/s][A

 22%|██▎       | 45/200 [00:06<00:19,  7.96it/s][A

 23%|██▎       | 46/200 [00:06<00:19,  7.96it/s][A

 24%|██▎       | 47/200 [00:06<00:19,  7.97it/s][A

 24%|██▍       | 48/200 [00:06<00:18,  8.01it/s][A

 24%|██▍       | 49/200 [00:06<00:18,  8.03it/s][A

 25%|██▌       | 50/200 [00:06<00:18,  8.06it/s][A

 26%|██▌       | 51/200 [00:06<00:18,  8.08it/s][A

 26%|██▌       | 52/200 [00:07<00:18,  8.08it/s][A

 26%|██▋       | 53/200 [00:07<00:18,  8.08it/s][A

 27%|██▋       | 54/200 [00:07<00:18,  8.08it/s][A

 28%|██▊       | 55/200 [00:07<00:17,  8.10it/s][A

 28%|██▊       | 56/200 [00:07<00:17,  8.11it/s][A

 28%|██▊       | 57/200 [00:07<00:17,  8.13it/s][A

 29%|██▉       | 58/200 [00:07<00:17,  8.14it/s][A

 30%|██▉       | 59/200 [00:07<00:17,  8.14it/s][A

 30%|███       | 60/200 [00:08<00:17,  8.14it/s][A

 30%|███       | 61/200 [00:08<00:17,  8.15it/s][A

 31%|███       | 62/200 [00:08<00:16,  8.15it/s][A

 32%|███▏      | 63/200 [00:08<00:16,  8.31it/s][A

 32%|███▏      | 64/200 [00:08<00:16,  8.39it/s][A

 32%|███▎      | 65/200 [00:08<00:15,  8.48it/s][A

 33%|███▎      | 66/200 [00:08<00:15,  8.57it/s][A

 34%|███▎      | 67/200 [00:08<00:15,  8.61it/s][A

 34%|███▍      | 68/200 [00:09<00:15,  8.64it/s][A

 34%|███▍      | 69/200 [00:09<00:15,  8.66it/s][A

 35%|███▌      | 70/200 [00:09<00:14,  8.69it/s][A

 36%|███▌      | 71/200 [00:09<00:14,  8.73it/s][A

 36%|███▌      | 72/200 [00:09<00:14,  8.76it/s][A

 36%|███▋      | 73/200 [00:09<00:14,  8.78it/s][A

 37%|███▋      | 74/200 [00:09<00:14,  8.79it/s][A

 38%|███▊      | 75/200 [00:09<00:14,  8.80it/s][A

 38%|███▊      | 76/200 [00:09<00:14,  8.83it/s][A

 38%|███▊      | 77/200 [00:10<00:13,  8.81it/s][A

 39%|███▉      | 78/200 [00:10<00:13,  8.80it/s][A

 40%|███▉      | 79/200 [00:10<00:13,  8.90it/s][A

 40%|████      | 80/200 [00:10<00:13,  8.94it/s][A

 40%|████      | 81/200 [00:10<00:13,  8.99it/s][A

 41%|████      | 82/200 [00:10<00:13,  9.04it/s][A

 42%|████▏     | 83/200 [00:10<00:12,  9.06it/s][A

 42%|████▏     | 84/200 [00:10<00:12,  9.06it/s][A

 42%|████▎     | 85/200 [00:10<00:12,  9.08it/s][A

 43%|████▎     | 86/200 [00:11<00:12,  9.09it/s][A

 44%|████▎     | 87/200 [00:11<00:12,  9.10it/s][A

 44%|████▍     | 88/200 [00:11<00:12,  9.13it/s][A

 44%|████▍     | 89/200 [00:11<00:12,  9.14it/s][A

 45%|████▌     | 90/200 [00:11<00:12,  9.14it/s][A

 46%|████▌     | 91/200 [00:11<00:11,  9.16it/s][A

 46%|████▌     | 92/200 [00:11<00:11,  9.17it/s][A

 46%|████▋     | 93/200 [00:11<00:11,  9.17it/s][A

 47%|████▋     | 94/200 [00:11<00:11,  9.21it/s][A

 48%|████▊     | 95/200 [00:12<00:11,  9.23it/s][A

 48%|████▊     | 96/200 [00:12<00:11,  9.26it/s][A

 48%|████▊     | 97/200 [00:12<00:11,  9.24it/s][A

 49%|████▉     | 98/200 [00:12<00:11,  9.26it/s][A

 50%|████▉     | 99/200 [00:12<00:10,  9.28it/s][A

 50%|█████     | 100/200 [00:12<00:10,  9.34it/s][A

 50%|█████     | 101/200 [00:12<00:10,  9.41it/s][A

 51%|█████     | 102/200 [00:12<00:10,  9.46it/s][A

 52%|█████▏    | 103/200 [00:12<00:10,  9.43it/s][A

 52%|█████▏    | 104/200 [00:12<00:10,  9.46it/s][A

 52%|█████▎    | 105/200 [00:13<00:10,  9.50it/s][A

 53%|█████▎    | 106/200 [00:13<00:09,  9.54it/s][A

 54%|█████▎    | 107/200 [00:13<00:09,  9.57it/s][A

 54%|█████▍    | 108/200 [00:13<00:09,  9.60it/s][A

 55%|█████▍    | 109/200 [00:13<00:09,  9.59it/s][A

 55%|█████▌    | 110/200 [00:13<00:09,  9.63it/s][A

 56%|█████▌    | 111/200 [00:13<00:09,  9.65it/s][A

 56%|█████▌    | 112/200 [00:13<00:09,  9.65it/s][A

 56%|█████▋    | 113/200 [00:13<00:08,  9.69it/s][A

 57%|█████▋    | 114/200 [00:14<00:08,  9.73it/s][A

 57%|█████▊    | 115/200 [00:14<00:08,  9.76it/s][A

 58%|█████▊    | 116/200 [00:14<00:08,  9.79it/s][A

 58%|█████▊    | 117/200 [00:14<00:08,  9.81it/s][A

 59%|█████▉    | 118/200 [00:14<00:08,  9.83it/s][A

 60%|█████▉    | 119/200 [00:14<00:08,  9.85it/s][A

 60%|██████    | 120/200 [00:14<00:08,  9.87it/s][A

 60%|██████    | 121/200 [00:14<00:08,  9.87it/s][A

 61%|██████    | 122/200 [00:14<00:07,  9.87it/s][A

 62%|██████▏   | 123/200 [00:14<00:07,  9.91it/s][A

 62%|██████▎   | 125/200 [00:15<00:07,  9.93it/s][A

 64%|██████▎   | 127/200 [00:15<00:07,  9.99it/s][A

 64%|██████▍   | 129/200 [00:15<00:07, 10.05it/s][A

 66%|██████▌   | 131/200 [00:15<00:06, 10.07it/s][A

 66%|██████▋   | 133/200 [00:15<00:06, 10.08it/s][A

 68%|██████▊   | 135/200 [00:16<00:06, 10.12it/s][A

 68%|██████▊   | 137/200 [00:16<00:06, 10.16it/s][A

 70%|██████▉   | 139/200 [00:16<00:05, 10.23it/s][A

 70%|███████   | 141/200 [00:16<00:05, 10.25it/s][A

 72%|███████▏  | 143/200 [00:16<00:05, 10.26it/s][A

 72%|███████▎  | 145/200 [00:17<00:05, 10.28it/s][A

 74%|███████▎  | 147/200 [00:17<00:05, 10.34it/s][A

 74%|███████▍  | 149/200 [00:17<00:04, 10.39it/s][A

 76%|███████▌  | 151/200 [00:17<00:04, 10.43it/s][A

 76%|███████▋  | 153/200 [00:17<00:04, 10.48it/s][A

 78%|███████▊  | 155/200 [00:18<00:04, 10.51it/s][A

 78%|███████▊  | 157/200 [00:18<00:04, 10.50it/s][A

 80%|███████▉  | 159/200 [00:18<00:03, 10.54it/s][A

 80%|████████  | 161/200 [00:18<00:03, 10.69it/s][A

 82%|████████▏ | 163/200 [00:18<00:03, 10.92it/s][A

 82%|████████▎ | 165/200 [00:18<00:03, 11.11it/s][A

 84%|████████▎ | 167/200 [00:19<00:02, 11.28it/s][A

 84%|████████▍ | 169/200 [00:19<00:02, 11.38it/s][A

 86%|████████▌ | 171/200 [00:19<00:02, 11.46it/s][A

 86%|████████▋ | 173/200 [00:19<00:02, 11.56it/s][A

 88%|████████▊ | 175/200 [00:19<00:02, 11.63it/s][A

 88%|████████▊ | 177/200 [00:19<00:01, 11.73it/s][A

 90%|████████▉ | 179/200 [00:20<00:01, 11.87it/s][A

 90%|█████████ | 181/200 [00:20<00:01, 12.03it/s][A

 92%|█████████▏| 183/200 [00:20<00:01, 12.14it/s][A

 92%|█████████▎| 185/200 [00:20<00:01, 12.41it/s][A

 94%|█████████▎| 187/200 [00:20<00:01, 12.58it/s][A

 94%|█████████▍| 189/200 [00:20<00:00, 12.97it/s][A

 96%|█████████▌| 191/200 [00:21<00:00, 13.22it/s][A

 96%|█████████▋| 193/200 [00:21<00:00, 13.51it/s][A

 98%|█████████▊| 195/200 [00:21<00:00, 13.79it/s][A

 98%|█████████▊| 197/200 [00:21<00:00, 14.05it/s][A

100%|█████████▉| 199/200 [00:21<00:00, 14.31it/s][A
100%|██████████| 200/200 [00:21<00:00,  9.23it/s]

Analyzing layers: 100%|██████████| 2/2 [01:12<00:00, 36.32s/it]
Analyzing layers: 100%|██████████| 2/2 [01:12<00:00, 36.27s/it]
hellaswag[acc_norm]: 72.0
Results for layer: output
Accuracy: 72.0
Improvement over INT4 baseline: 4.0